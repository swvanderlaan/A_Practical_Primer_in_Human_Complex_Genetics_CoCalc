<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Two Sample Mendelian Randomisation | A Practical Primer in Human Complex Genetics</title>
  <meta name="description" content="This is a practical primer in human complex genetics with a use-case in cardiovascular disease. The output format for this primer is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.38.1 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Two Sample Mendelian Randomisation | A Practical Primer in Human Complex Genetics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a practical primer in human complex genetics with a use-case in cardiovascular disease. The output format for this primer is bookdown::gitbook." />
  <meta name="github-repo" content="swvanderlaan/A_Practical_Primer_in_Human_Complex_Genetics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Two Sample Mendelian Randomisation | A Practical Primer in Human Complex Genetics" />
  
  <meta name="twitter:description" content="This is a practical primer in human complex genetics with a use-case in cardiovascular disease. The output format for this primer is bookdown::gitbook." />
  

<meta name="author" content="dr. Sander W. van der Laan  " />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mr_mrbase.html"/>
<link rel="next" href="epilogue.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<link href="libs/htmltools-fill-0.5.8/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Practical Primer in Human Complex Genetics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this primer</a></li>
<li class="chapter" data-level="2" data-path="somebackgroundreading.html"><a href="somebackgroundreading.html"><i class="fa fa-check"></i><b>2</b> Some background reading</a></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting started</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started.html"><a href="getting-started.html#cocalc-vs.-standalone"><i class="fa fa-check"></i><b>3.1</b> CoCalc vs. Standalone</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="getting-started-programs.html"><a href="getting-started-programs.html"><i class="fa fa-check"></i><b>4</b> Getting started - programs</a>
<ul>
<li class="chapter" data-level="4.1" data-path="getting-started-programs.html"><a href="getting-started-programs.html#rstudio"><i class="fa fa-check"></i><b>4.1</b> RStudio</a></li>
<li class="chapter" data-level="4.2" data-path="getting-started-programs.html"><a href="getting-started-programs.html#plink"><i class="fa fa-check"></i><b>4.2</b> PLINK</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="getting-started-programs.html"><a href="getting-started-programs.html#alternatives-to-plink"><i class="fa fa-check"></i><b>4.2.1</b> Alternatives to <code>PLINK</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="getting-started-programs.html"><a href="getting-started-programs.html#other-programs"><i class="fa fa-check"></i><b>4.3</b> Other programs</a></li>
<li class="chapter" data-level="4.4" data-path="getting-started-programs.html"><a href="getting-started-programs.html#did-you-choose"><i class="fa fa-check"></i><b>4.4</b> Did you choose?</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html"><i class="fa fa-check"></i><b>5</b> Getting started - Standalone</a>
<ul>
<li class="chapter" data-level="5.1" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#the-data-you-need"><i class="fa fa-check"></i><b>5.1</b> The data you need</a></li>
<li class="chapter" data-level="5.2" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#terminal"><i class="fa fa-check"></i><b>5.2</b> Terminal</a></li>
<li class="chapter" data-level="5.3" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#navigating-the-terminal"><i class="fa fa-check"></i><b>5.3</b> Navigating the Terminal</a></li>
<li class="chapter" data-level="5.4" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#installing-the-software"><i class="fa fa-check"></i><b>5.4</b> Installing the software</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#brew"><i class="fa fa-check"></i><b>5.4.1</b> brew</a></li>
<li class="chapter" data-level="5.4.2" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#plink-1"><i class="fa fa-check"></i><b>5.4.2</b> PLINK</a></li>
<li class="chapter" data-level="5.4.3" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>5.4.3</b> Installing R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="getting-started-standalone.html"><a href="getting-started-standalone.html#are-you-ready"><i class="fa fa-check"></i><b>5.5</b> Are you ready?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html"><i class="fa fa-check"></i><b>6</b> Getting started - CoCalc</a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#starting-the-course-on-cocalc"><i class="fa fa-check"></i><b>6.1</b> Starting the course on CoCalc</a></li>
<li class="chapter" data-level="6.2" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#but-wait-what-is-cocalc-anyway"><i class="fa fa-check"></i><b>6.2</b> But wait, what is CoCalc anyway?</a></li>
<li class="chapter" data-level="6.3" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#okay-and-whats-a-jupyter-notebook"><i class="fa fa-check"></i><b>6.3</b> Okay, and what’s a Jupyter Notebook?</a></li>
<li class="chapter" data-level="6.4" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#how-does-a-jupyter-notebook-work"><i class="fa fa-check"></i><b>6.4</b> How does a Jupyter Notebook work?</a></li>
<li class="chapter" data-level="6.5" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#and-what-is-the-force-behind-a-jupyter-notebook"><i class="fa fa-check"></i><b>6.5</b> And what is the Force behind a Jupyter Notebook?</a></li>
<li class="chapter" data-level="6.6" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#how-to-use-a-jupyter-notebook"><i class="fa fa-check"></i><b>6.6</b> How to use a Jupyter Notebook</a></li>
<li class="chapter" data-level="6.7" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#trouble-shooting-juptyer-notebook"><i class="fa fa-check"></i><b>6.7</b> Trouble shooting Juptyer Notebook</a></li>
<li class="chapter" data-level="6.8" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#cocalc-and-this-practical-primer"><i class="fa fa-check"></i><b>6.8</b> CoCalc and this Practical Primer</a></li>
<li class="chapter" data-level="6.9" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#beginning-your-own-jupyter-notebook-with-a-r-kernel"><i class="fa fa-check"></i><b>6.9</b> Beginning your own Jupyter Notebook with a <code>R</code> kernel</a></li>
<li class="chapter" data-level="6.10" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#beginning-your-own-terminal-for-bash-code"><i class="fa fa-check"></i><b>6.10</b> Beginning your own Terminal for <code>bash</code> code</a></li>
<li class="chapter" data-level="6.11" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#this-book-and-cocalc"><i class="fa fa-check"></i><b>6.11</b> This book and CoCalc</a></li>
<li class="chapter" data-level="6.12" data-path="getting-started-cocalc.html"><a href="getting-started-cocalc.html#are-you-ready-1"><i class="fa fa-check"></i><b>6.12</b> Are you ready?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gwas-basics.html"><a href="gwas-basics.html"><i class="fa fa-check"></i><b>7</b> Steps in a Genome-Wide Association Study</a>
<ul>
<li class="chapter" data-level="7.1" data-path="gwas-basics.html"><a href="gwas-basics.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="gwas-basics.html"><a href="gwas-basics.html#setting-the-stage"><i class="fa fa-check"></i><b>7.1.1</b> Setting the stage</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="gwas-basics.html"><a href="gwas-basics.html#converting-the-data"><i class="fa fa-check"></i><b>7.2</b> Converting the data</a></li>
<li class="chapter" data-level="7.3" data-path="gwas-basics.html"><a href="gwas-basics.html#quality-control"><i class="fa fa-check"></i><b>7.3</b> Quality control</a></li>
<li class="chapter" data-level="7.4" data-path="gwas-basics.html"><a href="gwas-basics.html#lets-get-our-hands-dirty"><i class="fa fa-check"></i><b>7.4</b> Let’s get our hands dirty</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html"><i class="fa fa-check"></i><b>8</b> Sample QC</a>
<ul>
<li class="chapter" data-level="8.1" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#sex"><i class="fa fa-check"></i><b>8.1</b> Sex</a></li>
<li class="chapter" data-level="8.2" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#sample-call-rates"><i class="fa fa-check"></i><b>8.2</b> Sample call rates</a></li>
<li class="chapter" data-level="8.3" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#heterozygosity-rate"><i class="fa fa-check"></i><b>8.3</b> Heterozygosity rate</a></li>
<li class="chapter" data-level="8.4" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#relatedness"><i class="fa fa-check"></i><b>8.4</b> Relatedness</a></li>
<li class="chapter" data-level="8.5" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#ancestral-background"><i class="fa fa-check"></i><b>8.5</b> Ancestral background</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#g-phase-1"><i class="fa fa-check"></i><b>8.5.1</b> 1000G phase 1</a></li>
<li class="chapter" data-level="8.5.2" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#principal-component-analysis"><i class="fa fa-check"></i><b>8.5.2</b> Principal component analysis</a></li>
<li class="chapter" data-level="8.5.3" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#plotting-the-pca-results"><i class="fa fa-check"></i><b>8.5.3</b> Plotting the PCA results</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#removing-samples"><i class="fa fa-check"></i><b>8.6</b> Removing samples</a></li>
<li class="chapter" data-level="8.7" data-path="gwas-basics-sample-qc.html"><a href="gwas-basics-sample-qc.html#the-next-step"><i class="fa fa-check"></i><b>8.7</b> The next step</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html"><i class="fa fa-check"></i><b>9</b> Per-SNP QC</a>
<ul>
<li class="chapter" data-level="9.1" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#snp-call-rates"><i class="fa fa-check"></i><b>9.1</b> SNP call rates</a></li>
<li class="chapter" data-level="9.2" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#differential-snp-call-rates"><i class="fa fa-check"></i><b>9.2</b> Differential SNP call rates</a></li>
<li class="chapter" data-level="9.3" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#allele-frequencies"><i class="fa fa-check"></i><b>9.3</b> Allele frequencies</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#a-note-on-allele-coding"><i class="fa fa-check"></i><b>9.3.1</b> A note on allele coding</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#hardy-weinberg-equilibrium"><i class="fa fa-check"></i><b>9.4</b> Hardy-Weinberg Equilibrium</a></li>
<li class="chapter" data-level="9.5" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#final-snp-qc"><i class="fa fa-check"></i><b>9.5</b> Final SNP QC</a></li>
<li class="chapter" data-level="9.6" data-path="gwas_basics_snp_qc.html"><a href="gwas_basics_snp_qc.html#a-milestone"><i class="fa fa-check"></i><b>9.6</b> A Milestone</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="gwas_testing.html"><a href="gwas_testing.html"><i class="fa fa-check"></i><b>10</b> Genome-Wide Association Study</a>
<ul>
<li class="chapter" data-level="10.1" data-path="gwas_testing.html"><a href="gwas_testing.html#exploring-the-data"><i class="fa fa-check"></i><b>10.1</b> Exploring the data</a></li>
<li class="chapter" data-level="10.2" data-path="gwas_testing.html"><a href="gwas_testing.html#genetic-models"><i class="fa fa-check"></i><b>10.2</b> Genetic models</a></li>
<li class="chapter" data-level="10.3" data-path="gwas_testing.html"><a href="gwas_testing.html#logistic-regression"><i class="fa fa-check"></i><b>10.3</b> Logistic regression</a></li>
<li class="chapter" data-level="10.4" data-path="gwas_testing.html"><a href="gwas_testing.html#lets-get-visual"><i class="fa fa-check"></i><b>10.4</b> Let’s get visual</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="gwas_visuals.html"><a href="gwas_visuals.html"><i class="fa fa-check"></i><b>11</b> GWAS visualisation</a>
<ul>
<li class="chapter" data-level="11.0.1" data-path="gwas_visuals.html"><a href="gwas_visuals.html#qq-plots"><i class="fa fa-check"></i><b>11.0.1</b> QQ plots</a></li>
<li class="chapter" data-level="11.1" data-path="gwas_visuals.html"><a href="gwas_visuals.html#manhattan-plots"><i class="fa fa-check"></i><b>11.1</b> Manhattan plots</a></li>
<li class="chapter" data-level="11.2" data-path="gwas_visuals.html"><a href="gwas_visuals.html#other-plots"><i class="fa fa-check"></i><b>11.2</b> Other plots</a></li>
<li class="chapter" data-level="11.3" data-path="gwas_visuals.html"><a href="gwas_visuals.html#interactive-plots"><i class="fa fa-check"></i><b>11.3</b> Interactive plots</a></li>
<li class="chapter" data-level="11.4" data-path="gwas_visuals.html"><a href="gwas_visuals.html#stop-playing-around"><i class="fa fa-check"></i><b>11.4</b> Stop playing around</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="wtccc1_intro.html"><a href="wtccc1_intro.html"><i class="fa fa-check"></i><b>12</b> The Welcome Trust Case-Control Consortium</a>
<ul>
<li class="chapter" data-level="12.1" data-path="wtccc1_intro.html"><a href="wtccc1_intro.html#genotyping"><i class="fa fa-check"></i><b>12.1</b> Genotyping</a></li>
<li class="chapter" data-level="12.2" data-path="wtccc1_intro.html"><a href="wtccc1_intro.html#the-data"><i class="fa fa-check"></i><b>12.2</b> The data</a></li>
<li class="chapter" data-level="12.3" data-path="wtccc1_intro.html"><a href="wtccc1_intro.html#assignment"><i class="fa fa-check"></i><b>12.3</b> Assignment</a></li>
<li class="chapter" data-level="12.4" data-path="wtccc1_intro.html"><a href="wtccc1_intro.html#there-you-go"><i class="fa fa-check"></i><b>12.4</b> There you go</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="wtccc1.html"><a href="wtccc1.html"><i class="fa fa-check"></i><b>13</b> WTCCC1: a GWAS on coronary artery disease (CAD)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="wtccc1.html"><a href="wtccc1.html#quality-control-1"><i class="fa fa-check"></i><b>13.1</b> Quality control</a></li>
<li class="chapter" data-level="13.2" data-path="wtccc1.html"><a href="wtccc1.html#ancestral-background-1"><i class="fa fa-check"></i><b>13.2</b> Ancestral background</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="wtccc1.html"><a href="wtccc1.html#preparing-pca"><i class="fa fa-check"></i><b>13.2.1</b> Preparing PCA</a></li>
<li class="chapter" data-level="13.2.2" data-path="wtccc1.html"><a href="wtccc1.html#running-pca"><i class="fa fa-check"></i><b>13.2.2</b> Running PCA</a></li>
<li class="chapter" data-level="13.2.3" data-path="wtccc1.html"><a href="wtccc1.html#plotting-pca"><i class="fa fa-check"></i><b>13.2.3</b> Plotting PCA</a></li>
<li class="chapter" data-level="13.2.4" data-path="wtccc1.html"><a href="wtccc1.html#removing-samples-1"><i class="fa fa-check"></i><b>13.2.4</b> Removing samples</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="wtccc1.html"><a href="wtccc1.html#association-testing"><i class="fa fa-check"></i><b>13.3</b> Association testing</a></li>
<li class="chapter" data-level="13.4" data-path="wtccc1.html"><a href="wtccc1.html#replication"><i class="fa fa-check"></i><b>13.4</b> Replication!</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="post_gwas.html"><a href="post_gwas.html"><i class="fa fa-check"></i><b>14</b> Post-GWAS Analyses</a>
<ul>
<li class="chapter" data-level="14.1" data-path="post_gwas.html"><a href="post_gwas.html#clumping"><i class="fa fa-check"></i><b>14.1</b> Clumping</a></li>
<li class="chapter" data-level="14.2" data-path="post_gwas.html"><a href="post_gwas.html#conditional-analyses"><i class="fa fa-check"></i><b>14.2</b> Conditional analyses</a></li>
<li class="chapter" data-level="14.3" data-path="post_gwas.html"><a href="post_gwas.html#statistical-finemapping"><i class="fa fa-check"></i><b>14.3</b> Statistical finemapping</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="post_gwas.html"><a href="post_gwas.html#finemap"><i class="fa fa-check"></i><b>14.3.1</b> FINEMAP</a></li>
<li class="chapter" data-level="14.3.2" data-path="post_gwas.html"><a href="post_gwas.html#locuszoom"><i class="fa fa-check"></i><b>14.3.2</b> LocusZoom</a></li>
<li class="chapter" data-level="14.3.3" data-path="post_gwas.html"><a href="post_gwas.html#susie"><i class="fa fa-check"></i><b>14.3.3</b> SuSIE</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="post_gwas.html"><a href="post_gwas.html#fuma-functional-mapping-and-annotation-of-gwas"><i class="fa fa-check"></i><b>14.4</b> FUMA: FUnctional Mapping and Annotation of GWAS</a></li>
<li class="chapter" data-level="14.5" data-path="post_gwas.html"><a href="post_gwas.html#phenome-wide-association-study"><i class="fa fa-check"></i><b>14.5</b> Phenome-wide association study</a></li>
<li class="chapter" data-level="14.6" data-path="post_gwas.html"><a href="post_gwas.html#colocalization"><i class="fa fa-check"></i><b>14.6</b> Colocalization</a></li>
<li class="chapter" data-level="14.7" data-path="post_gwas.html"><a href="post_gwas.html#genetic-correlation"><i class="fa fa-check"></i><b>14.7</b> Genetic correlation</a></li>
<li class="chapter" data-level="14.8" data-path="post_gwas.html"><a href="post_gwas.html#causal-inference-mendelian-randomization"><i class="fa fa-check"></i><b>14.8</b> Causal inference: Mendelian Randomization</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="post_gwas.html"><a href="post_gwas.html#mrbase"><i class="fa fa-check"></i><b>14.8.1</b> MRBase</a></li>
<li class="chapter" data-level="14.8.2" data-path="post_gwas.html"><a href="post_gwas.html#twosamplemr"><i class="fa fa-check"></i><b>14.8.2</b> TwoSampleMR</a></li>
<li class="chapter" data-level="14.8.3" data-path="post_gwas.html"><a href="post_gwas.html#your-choice"><i class="fa fa-check"></i><b>14.8.3</b> Your choice</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="post_gwas.html"><a href="post_gwas.html#polygenic-scores"><i class="fa fa-check"></i><b>14.9</b> Polygenic scores</a></li>
<li class="chapter" data-level="14.10" data-path="post_gwas.html"><a href="post_gwas.html#what-comes-next"><i class="fa fa-check"></i><b>14.10</b> What comes next</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="fuma.html"><a href="fuma.html"><i class="fa fa-check"></i><b>15</b> Functional Mapping and Annotation of GWAS</a>
<ul>
<li class="chapter" data-level="15.1" data-path="fuma.html"><a href="fuma.html#assignment-1"><i class="fa fa-check"></i><b>15.1</b> Assignment</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="fuma.html"><a href="fuma.html#tutorial"><i class="fa fa-check"></i><b>15.1.1</b> Tutorial</a></li>
<li class="chapter" data-level="15.1.2" data-path="fuma.html"><a href="fuma.html#create-the-input"><i class="fa fa-check"></i><b>15.1.2</b> Create the input</a></li>
<li class="chapter" data-level="15.1.3" data-path="fuma.html"><a href="fuma.html#run-fuma---snp-to-gene"><i class="fa fa-check"></i><b>15.1.3</b> Run FUMA - SNP to gene</a></li>
<li class="chapter" data-level="15.1.4" data-path="fuma.html"><a href="fuma.html#run-fuma---gene-to-function"><i class="fa fa-check"></i><b>15.1.4</b> Run FUMA - Gene to function</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="fuma.html"><a href="fuma.html#some-closing-thoughts"><i class="fa fa-check"></i><b>15.2</b> Some closing thoughts</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="phewas.html"><a href="phewas.html"><i class="fa fa-check"></i><b>16</b> Phenome-Wide Association Study</a>
<ul>
<li class="chapter" data-level="16.1" data-path="phewas.html"><a href="phewas.html#whats-next"><i class="fa fa-check"></i><b>16.1</b> What’s next?</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="mr_mrbase.html"><a href="mr_mrbase.html"><i class="fa fa-check"></i><b>17</b> MRBase</a>
<ul>
<li class="chapter" data-level="17.1" data-path="mr_mrbase.html"><a href="mr_mrbase.html#the-end"><i class="fa fa-check"></i><b>17.1</b> The end?</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html"><i class="fa fa-check"></i><b>18</b> Two Sample Mendelian Randomisation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#loading-the-package"><i class="fa fa-check"></i><b>18.1</b> Loading the package</a></li>
<li class="chapter" data-level="18.2" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#available-outcome"><i class="fa fa-check"></i><b>18.2</b> Available outcome</a></li>
<li class="chapter" data-level="18.3" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#instruments"><i class="fa fa-check"></i><b>18.3</b> Instruments</a></li>
<li class="chapter" data-level="18.4" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#clumping-1"><i class="fa fa-check"></i><b>18.4</b> Clumping</a></li>
<li class="chapter" data-level="18.5" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#outcomes"><i class="fa fa-check"></i><b>18.5</b> Outcomes</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#harmonisation"><i class="fa fa-check"></i><b>18.5.1</b> Harmonisation</a></li>
<li class="chapter" data-level="18.5.2" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#mendelian-randomisation"><i class="fa fa-check"></i><b>18.5.2</b> Mendelian randomisation</a></li>
<li class="chapter" data-level="18.5.3" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#heterogeneity-pleiotropy"><i class="fa fa-check"></i><b>18.5.3</b> Heterogeneity &amp; Pleiotropy</a></li>
<li class="chapter" data-level="18.5.4" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#leave-one-out"><i class="fa fa-check"></i><b>18.5.4</b> Leave-one-out</a></li>
<li class="chapter" data-level="18.5.5" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#visualisation"><i class="fa fa-check"></i><b>18.5.5</b> Visualisation</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="mr_twosamplemr.html"><a href="mr_twosamplemr.html#the-end-1"><i class="fa fa-check"></i><b>18.6</b> The end?</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="epilogue.html"><a href="epilogue.html"><i class="fa fa-check"></i><b>19</b> Epilogue</a>
<ul>
<li class="chapter" data-level="19.1" data-path="epilogue.html"><a href="epilogue.html#course-lecturers"><i class="fa fa-check"></i><b>19.1</b> 2024 Course Lecturers</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="regional_plot.html"><a href="regional_plot.html"><i class="fa fa-check"></i><b>20</b> Regional association plots</a>
<ul>
<li class="chapter" data-level="20.1" data-path="regional_plot.html"><a href="regional_plot.html#locuszoom-1"><i class="fa fa-check"></i><b>20.1</b> LocusZoom</a></li>
<li class="chapter" data-level="20.2" data-path="regional_plot.html"><a href="regional_plot.html#racer"><i class="fa fa-check"></i><b>20.2</b> RACER</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="eigensoft.html"><a href="eigensoft.html"><i class="fa fa-check"></i><b>21</b> EIGENSOFT</a>
<ul>
<li class="chapter" data-level="21.1" data-path="eigensoft.html"><a href="eigensoft.html#install-homebrew"><i class="fa fa-check"></i><b>21.1</b> Install homebrew</a></li>
<li class="chapter" data-level="21.2" data-path="eigensoft.html"><a href="eigensoft.html#install-missing-packages"><i class="fa fa-check"></i><b>21.2</b> Install missing packages</a></li>
<li class="chapter" data-level="21.3" data-path="eigensoft.html"><a href="eigensoft.html#installing-eigensoft"><i class="fa fa-check"></i><b>21.3</b> Installing EIGENSOFT</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="answers.html"><a href="answers.html"><i class="fa fa-check"></i><b>22</b> Answers to the questions</a>
<ul>
<li class="chapter" data-level="22.1" data-path="answers.html"><a href="answers.html#chapter-3.1-gwas-basics"><i class="fa fa-check"></i><b>22.1</b> Chapter 3.1: GWAS Basics</a></li>
<li class="chapter" data-level="22.2" data-path="answers.html"><a href="answers.html#chapter-3.4-gwas-basics---association-testing"><i class="fa fa-check"></i><b>22.2</b> Chapter 3.4: GWAS Basics - Association testing</a></li>
<li class="chapter" data-level="22.3" data-path="answers.html"><a href="answers.html#chapter-3.5-gwas-visualization"><i class="fa fa-check"></i><b>22.3</b> Chapter 3.5: GWAS visualization</a></li>
<li class="chapter" data-level="22.4" data-path="answers.html"><a href="answers.html#chapter-5.4-fuma"><i class="fa fa-check"></i><b>22.4</b> Chapter 5.4: FUMA</a></li>
<li class="chapter" data-level="22.5" data-path="answers.html"><a href="answers.html#chapter-5.7-twosample-mr"><i class="fa fa-check"></i><b>22.5</b> Chapter 5.7: TwoSample MR</a></li>
<li class="chapter" data-level="22.6" data-path="answers.html"><a href="answers.html#chapter-8.1-regional-association-plots"><i class="fa fa-check"></i><b>22.6</b> Chapter 8.1: Regional association plots</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i><b>23</b> Licenses and disclaimers</a>
<ul>
<li class="chapter" data-level="23.1" data-path="license.html"><a href="license.html#copyright"><i class="fa fa-check"></i><b>23.1</b> Copyright</a></li>
<li class="chapter" data-level="23.2" data-path="license.html"><a href="license.html#disclaimer"><i class="fa fa-check"></i><b>23.2</b> Disclaimer</a></li>
<li class="chapter" data-level="23.3" data-path="license.html"><a href="license.html#images-and-data-used"><i class="fa fa-check"></i><b>23.3</b> Images and data used</a></li>
<li class="chapter" data-level="23.4" data-path="license.html"><a href="license.html#copyright-1"><i class="fa fa-check"></i><b>23.4</b> Copyright</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>24</b> Colophon</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://vanderlaanand.science" target="blank">&copy; 1979-2024. Sander W. van der Laan.</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Practical Primer in Human Complex Genetics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mr_twosamplemr" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">18</span> Two Sample Mendelian Randomisation<a href="mr_twosamplemr.html#mr_twosamplemr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- ![](./img/_headers/banner_man_standing_dna.png){width=100%} -->
<p>So you took the hard way. You want to get your hands dirty yourself. Your choice.</p>
<p>As I wrote, we will use the <code>TwoSampleMR</code> package to assess the causal effect of type 2 diabetes on coronary artery disease and ischemic stroke.</p>
<p>Briefly, the workflow of a Two-Sample MR is as follows (see also diagram below):</p>
<ol style="list-style-type: decimal">
<li>Select instruments for the exposure (perform LD clumping if necessary)</li>
<li>Extract the instruments from the MR Base GWAS database for the outcomes of interest</li>
<li>Harmonise the effect sizes for the instruments on the exposures and the outcomes to be each for the same reference allele</li>
<li>Perform MR analysis, sensitivity analyses, create plots, compile reports</li>
</ol>
<p><img src="img/twosamplemr.png" /></p>
<div id="loading-the-package" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Loading the package<a href="mr_twosamplemr.html#loading-the-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>TwoSampleMR</code> is free use. It used to require server-authentication using a gmail-account, now it doesn’t anymore. Should run into an issue, please refer to <a href="https://mrcieu.github.io/TwoSampleMR/articles/introduction.html" target="_blank">this page</a>.</p>
<p>First we load the package.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="mr_twosamplemr.html#cb89-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TwoSampleMR&quot;</span>)</span>
<span id="cb89-2"><a href="mr_twosamplemr.html#cb89-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MRInstruments&quot;</span>)</span>
<span id="cb89-3"><a href="mr_twosamplemr.html#cb89-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ieugwasr&quot;</span>)</span></code></pre></div>
</div>
<div id="available-outcome" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Available outcome<a href="mr_twosamplemr.html#available-outcome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are ready to load in the available outcomes.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="mr_twosamplemr.html#cb90-1" tabindex="-1"></a>ao_twosamplemr <span class="ot">&lt;-</span> <span class="fu">available_outcomes</span>()</span></code></pre></div>
</div>
<div id="instruments" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Instruments<a href="mr_twosamplemr.html#instruments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>MRInstruments</code>-package, which comes with <code>TwoSampleMR</code>, includes several types of instruments:</p>
<ul>
<li><em>gwas_catalog</em>, which includes data from GWAS collected by the GWAS Catalog</li>
<li><em>metab_qtls</em>, all known quantitative trait loci (meQTLs) associated to circulating metabolites</li>
<li><em>proteomic_qtls</em>, all known protein QTLs (pQTLs) associated to circulating protein levels</li>
<li><em>gtex_eqtl</em>, all known expression QTLs (eQTLs) associated to gene expression in 53 different tissues from GTEx Portal</li>
<li><em>aries_mqtl</em>, all known methylation QTLs (mQTLs) associated to DNA methylation in blood from ARIES</li>
</ul>
<p>Let’s select T2D associated instruments.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="mr_twosamplemr.html#cb91-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gwas_catalog&quot;</span>)</span>
<span id="cb91-2"><a href="mr_twosamplemr.html#cb91-2" tabindex="-1"></a>t2d_gwas <span class="ot">&lt;-</span> <span class="fu">subset</span>(gwas_catalog, <span class="fu">grepl</span>(<span class="st">&quot;Mahajan&quot;</span>, Author) <span class="sc">&amp;</span> PubmedID <span class="sc">==</span> <span class="st">&quot;24509480&quot;</span> <span class="sc">&amp;</span> Phenotype <span class="sc">==</span> <span class="st">&quot;Type 2 diabetes&quot;</span>)</span>
<span id="cb91-3"><a href="mr_twosamplemr.html#cb91-3" tabindex="-1"></a>t2d_exp_dat <span class="ot">&lt;-</span> <span class="fu">format_data</span>(t2d_gwas)</span></code></pre></div>
</div>
<div id="clumping-1" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Clumping<a href="mr_twosamplemr.html#clumping-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Like with identifying independent GWAS hits, it is important for TwoSampleMR to ensure that the instruments for the exposure are independent. We can use MR Base to perform clumping. The European samples from the 1000 genomes project are used to estimate LD between SNPs. You can provide a list of SNP IDs, the SNPs will be extracted from 1000 genomes data, LD calculated between them, and amongst those SNPs that have LD R-square above the specified threshold only the SNP with the lowest P-value will be retained. To do this, use the following command.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="mr_twosamplemr.html#cb92-1" tabindex="-1"></a>t2d_exp_dat <span class="ot">&lt;-</span> <span class="fu">clump_data</span>(t2d_exp_dat)</span></code></pre></div>
</div>
<div id="outcomes" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> Outcomes<a href="mr_twosamplemr.html#outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Right, so now we are ready to select the proper outcome, CAD. There are multiple datasets available in MRBase, the database used by <code>TwoSampleMR</code>. Let’s review them all and select one with the largest overlap with our exposure SNPs.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="mr_twosamplemr.html#cb93-1" tabindex="-1"></a>ao_twosamplemr[<span class="fu">grepl</span>(<span class="st">&quot;heart disease&quot;</span>, ao_twosamplemr<span class="sc">$</span>trait), ]</span></code></pre></div>
<pre><code>## Rows: 31
## Columns: 25
## $ id           &lt;chr&gt; &quot;ukb-e-I25_CSA&quot;, &quot;ukb-e-I25_AFR&quot;, &quot;ukb-d-I9_IHD&quot;, &quot;ukb-d-…
## $ trait        &lt;chr&gt; &quot;I25 Chronic ischaemic heart disease&quot;, &quot;I25 Chronic ischa…
## $ group_name   &lt;chr&gt; &quot;public&quot;, &quot;public&quot;, &quot;public&quot;, &quot;public&quot;, &quot;public&quot;, &quot;public…
## $ year         &lt;int&gt; 2020, 2020, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 201…
## $ author       &lt;chr&gt; &quot;Pan-UKB team&quot;, &quot;Pan-UKB team&quot;, &quot;Neale lab&quot;, &quot;Neale lab&quot;,…
## $ sex          &lt;chr&gt; &quot;Males and Females&quot;, &quot;Males and Females&quot;, &quot;Males and Fema…
## $ population   &lt;chr&gt; &quot;South Asian&quot;, &quot;African American or Afro-Caribbean&quot;, &quot;Eur…
## $ unit         &lt;chr&gt; &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;SD&quot;, &quot;SD&quot;, &quot;SD&quot;, &quot;SD&quot;, &quot;SD…
## $ sample_size  &lt;int&gt; 8876, 6636, 361194, 361194, 361194, 463010, 463010, 46301…
## $ build        &lt;chr&gt; &quot;HG19/GRCh37&quot;, &quot;HG19/GRCh37&quot;, &quot;HG19/GRCh37&quot;, &quot;HG19/GRCh37…
## $ subcategory  &lt;chr&gt; &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA…
## $ category     &lt;chr&gt; &quot;Binary&quot;, &quot;Binary&quot;, &quot;Binary&quot;, &quot;Binary&quot;, &quot;Binary&quot;, &quot;Binary…
## $ ontology     &lt;chr&gt; &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA…
## $ doi          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ note         &lt;chr&gt; &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;41204#I259: Output from GW…
## $ ncase        &lt;int&gt; 1205, 302, 20857, 10157, 10157, 5861, 5771, 9330, 1195, 5…
## $ ncontrol     &lt;int&gt; 7671, 6334, 340337, 351037, 351037, 457149, 457239, 45368…
## $ consortium   &lt;chr&gt; &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;NA&quot;, &quot;MRC-IEU&quot;, &quot;MRC-IEU&quot;, &quot;MRC-…
## $ mr           &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ pmid         &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 26343387,…
## $ nsnp         &lt;int&gt; 9811287, 15478580, 13586589, 13295130, 13295130, 9851867,…
## $ coverage     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ study_design &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ priority     &lt;int&gt; 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 3, 0, 0, 0, …
## $ sd           &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
<p>It turns out there are several options listed below.</p>
<table>
<colgroup>
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="14%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Year</th>
<th>Author</th>
<th>Description</th>
<th>Ncases</th>
<th>Ncontrols</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ukb-d-I9_IHD</td>
<td>2018</td>
<td>Neale Labe</td>
<td>Ischaemic heart disease, wide definition</td>
<td>20857</td>
<td>340337</td>
</tr>
<tr class="even">
<td>ukb-d-I9_CHD_NOREV</td>
<td>2018</td>
<td>Neale Labe</td>
<td>Major coronary heart disease event excluding revascularizations 10157 351037</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>ieu-a-7</td>
<td>2015</td>
<td>Nikpay <em>et al.</em></td>
<td>Coronary artery disease</td>
<td>60801 123504</td>
<td></td>
</tr>
<tr class="even">
<td>ieu-a-9</td>
<td>2013</td>
<td>Deloukas <em>et al. </em></td>
<td>Coronary artery disease</td>
<td>63746 130681</td>
<td></td>
</tr>
<tr class="odd">
<td>ieu-a-8</td>
<td>2011</td>
<td>Schunkert <em>et al.</em></td>
<td>Coronary artery disease</td>
<td>22233</td>
<td>64762</td>
</tr>
</tbody>
</table>
<p>We will use the <code>ieu-a-7</code> dataset as this provides the latest and the greatest, but at the same time (when you go into the literature and dig up the publication) you need a good and sharp definition of the outcome you are interested in.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="mr_twosamplemr.html#cb95-1" tabindex="-1"></a>chd_out_dat <span class="ot">&lt;-</span> <span class="fu">extract_outcome_data</span>(</span>
<span id="cb95-2"><a href="mr_twosamplemr.html#cb95-2" tabindex="-1"></a>    <span class="at">snps =</span> t2d_exp_dat<span class="sc">$</span>SNP,</span>
<span id="cb95-3"><a href="mr_twosamplemr.html#cb95-3" tabindex="-1"></a>    <span class="co"># outcomes = &quot;UKB-a:534&quot; # - this one is deprecated, use the one below</span></span>
<span id="cb95-4"><a href="mr_twosamplemr.html#cb95-4" tabindex="-1"></a>    <span class="co"># Deprecated IDs being used? Detected numeric IDs. Trying to fix, but please note the changes below for future.</span></span>
<span id="cb95-5"><a href="mr_twosamplemr.html#cb95-5" tabindex="-1"></a>    <span class="co"># UKB-a:534  -&gt;  ukb-a-534</span></span>
<span id="cb95-6"><a href="mr_twosamplemr.html#cb95-6" tabindex="-1"></a>    <span class="at">outcomes =</span> <span class="st">&quot;ieu-a-7&quot;</span></span>
<span id="cb95-7"><a href="mr_twosamplemr.html#cb95-7" tabindex="-1"></a>)</span></code></pre></div>
<div id="harmonisation" class="section level3 hasAnchor" number="18.5.1">
<h3><span class="header-section-number">18.5.1</span> Harmonisation<a href="mr_twosamplemr.html#harmonisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is important to make sure that the effect allele associated to T2D of any given SNP is the same as the effect allele associated CAD. In other words, we need to harmonise the data.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="mr_twosamplemr.html#cb96-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">harmonise_data</span>(</span>
<span id="cb96-2"><a href="mr_twosamplemr.html#cb96-2" tabindex="-1"></a>    <span class="at">exposure_dat =</span> t2d_exp_dat,</span>
<span id="cb96-3"><a href="mr_twosamplemr.html#cb96-3" tabindex="-1"></a>    <span class="at">outcome_dat =</span> chd_out_dat</span>
<span id="cb96-4"><a href="mr_twosamplemr.html#cb96-4" tabindex="-1"></a>)</span></code></pre></div>
<!-- ### Drop duplicate datasets -->
<!-- After data harmonisation, users may find that their dataset contains duplicate exposure-outcome summary sets. This can arise, for example, when a GWAS consortium has released multiple results from separate GWAS analyses for the same trait.  -->
<!-- The best thing to do, is to prune the datasets so that only the exposure-outcome combination with the highested expected power is retained.  -->
<!-- In our case we only have 1 dataset for the exposure and 1 for the outcome. But if you don't, you can use the command below. -->
<!-- ```{r MR_powerprune} -->
<!-- dat <- power_prune(dat,  -->
<!--                    method = 1, -->
<!--                    dist.outcome = "binary") -->
<!-- ``` -->
</div>
<div id="mendelian-randomisation" class="section level3 hasAnchor" number="18.5.2">
<h3><span class="header-section-number">18.5.2</span> Mendelian randomisation<a href="mr_twosamplemr.html#mendelian-randomisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that the data is harmonised, we are ready to perform a MR and test for a causal relation of T2D with CAD.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="mr_twosamplemr.html#cb97-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">mr</span>(dat)</span>
<span id="cb97-2"><a href="mr_twosamplemr.html#cb97-2" tabindex="-1"></a></span>
<span id="cb97-3"><a href="mr_twosamplemr.html#cb97-3" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res, <span class="at">caption =</span> <span class="st">&quot;MR of type 2 diabetes and coronary artery disease&quot;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2d3632e04042cd0e012e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2d3632e04042cd0e012e">{"x":{"filter":"none","vertical":false,"caption":"<caption>MR of type 2 diabetes and coronary artery disease<\/caption>","data":[["24wk7G","24wk7G","24wk7G","24wk7G","24wk7G"],["ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7"],["Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7"],["Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes"],["MR Egger","Weighted median","Inverse variance weighted","Simple mode","Weighted mode"],[50,50,50,50,50],[0.07688428803997334,0.09865534595066436,0.1147545622280697,0.0643204268105102,0.09196445273887566],[0.03902125131072411,0.02441143970348356,0.01885363466619782,0.03783118492244482,0.0244179044057644],[0.05458508583346296,5.314275368544647e-05,1.153325073130974e-09,0.09543396754351889,0.0004447457330909151]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>id.exposure<\/th>\n      <th>id.outcome<\/th>\n      <th>outcome<\/th>\n      <th>exposure<\/th>\n      <th>method<\/th>\n      <th>nsnp<\/th>\n      <th>b<\/th>\n      <th>se<\/th>\n      <th>pval<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[5,6,7,8]},{"name":"id.exposure","targets":0},{"name":"id.outcome","targets":1},{"name":"outcome","targets":2},{"name":"exposure","targets":3},{"name":"method","targets":4},{"name":"nsnp","targets":5},{"name":"b","targets":6},{"name":"se","targets":7},{"name":"pval","targets":8}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<blockquote>
<p>Question: What is the causal effect of T2D on CAD? Can you describe this using the knowledge from the lecture and the results in the table.</p>
</blockquote>
<p>Several tests are applied. You can change the method(s) applied by using the <code>method_list</code> flag. Below a list of available methods.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="mr_twosamplemr.html#cb98-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">mr_method_list</span>(), <span class="at">caption =</span> <span class="st">&quot;Available MR methods&quot;</span>, row.names</span>
<span id="cb98-2"><a href="mr_twosamplemr.html#cb98-2" tabindex="-1"></a> <span class="ot">=</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>(#tab:MR_methods)Available MR methods</caption>
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="4%" />
<col width="31%" />
<col width="7%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">obj</th>
<th align="left">name</th>
<th align="left">PubmedID</th>
<th align="left">Description</th>
<th align="left">use_by_default</th>
<th align="left">heterogeneity_test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mr_wald_ratio</td>
<td align="left">Wald ratio</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_two_sample_ml</td>
<td align="left">Maximum likelihood</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">mr_egger_regression</td>
<td align="left">MR Egger</td>
<td align="left">26050253</td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">mr_egger_regression_bootstrap</td>
<td align="left">MR Egger (bootstrap)</td>
<td align="left">26050253</td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_simple_median</td>
<td align="left">Simple median</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_weighted_median</td>
<td align="left">Weighted median</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_penalised_weighted_median</td>
<td align="left">Penalised weighted median</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_ivw</td>
<td align="left">Inverse variance weighted</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">mr_ivw_radial</td>
<td align="left">IVW radial</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">mr_ivw_mre</td>
<td align="left">Inverse variance weighted (multiplicative random effects)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_ivw_fe</td>
<td align="left">Inverse variance weighted (fixed effects)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_simple_mode</td>
<td align="left">Simple mode</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_weighted_mode</td>
<td align="left">Weighted mode</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_weighted_mode_nome</td>
<td align="left">Weighted mode (NOME)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_simple_mode_nome</td>
<td align="left">Simple mode (NOME)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_raps</td>
<td align="left">Robust adjusted profile score (RAPS)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_sign</td>
<td align="left">Sign concordance test</td>
<td align="left"></td>
<td align="left">Tests for concordance of signs between exposure and outcome</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_uwr</td>
<td align="left">Unweighted regression</td>
<td align="left"></td>
<td align="left">Doesn’t use any weights</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
</div>
<div id="heterogeneity-pleiotropy" class="section level3 hasAnchor" number="18.5.3">
<h3><span class="header-section-number">18.5.3</span> Heterogeneity &amp; Pleiotropy<a href="mr_twosamplemr.html#heterogeneity-pleiotropy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many genetic variants are associated to multiple traits, thus <em>pleiotropy</em> is common and widespread in the human genome. This poses as an issue to tease apart causal relations in Mendelian randomisation.
<em>Vertical pleiotropy</em> arises because a SNP influences one trait, which in turn influences another. We can use MR to estimate the causal influence between the traits.
<em>Horizontal pleiotropy</em> arises due to SNPs influencing two traits through independent pathways<span class="citation">(<a href="#ref-hemani2018">Hemani G. 2018</a>)</span>.</p>
<p>Further, we should test for study heterogeneity.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="mr_twosamplemr.html#cb99-1" tabindex="-1"></a><span class="fu">mr_heterogeneity</span>(dat)</span></code></pre></div>
<pre><code>##   id.exposure id.outcome                              outcome        exposure
## 1      24wk7G    ieu-a-7 Coronary heart disease || id:ieu-a-7 Type 2 diabetes
## 2      24wk7G    ieu-a-7 Coronary heart disease || id:ieu-a-7 Type 2 diabetes
##                      method       Q Q_df      Q_pval
## 1                  MR Egger 82.1911   48 0.001545015
## 2 Inverse variance weighted 84.2921   49 0.001282616</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="mr_twosamplemr.html#cb101-1" tabindex="-1"></a><span class="fu">mr_pleiotropy_test</span>(dat)</span></code></pre></div>
<pre><code>##   id.exposure id.outcome                              outcome        exposure
## 1      24wk7G    ieu-a-7 Coronary heart disease || id:ieu-a-7 Type 2 diabetes
##   egger_intercept          se      pval
## 1     0.004478786 0.004043328 0.2735122</code></pre>
<blockquote>
<p>Question: What do the results of the heterogeneity and pleiotropy tests tell you?</p>
</blockquote>
</div>
<div id="leave-one-out" class="section level3 hasAnchor" number="18.5.4">
<h3><span class="header-section-number">18.5.4</span> Leave-one-out<a href="mr_twosamplemr.html#leave-one-out" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is also key to inspect the causal effects per SNP and perform a leave-one-out analysis.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="mr_twosamplemr.html#cb103-1" tabindex="-1"></a>res_single <span class="ot">&lt;-</span> <span class="fu">mr_singlesnp</span>(dat)</span>
<span id="cb103-2"><a href="mr_twosamplemr.html#cb103-2" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res_single, <span class="at">caption =</span> <span class="st">&quot;Single SNP MR analysis&quot;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-49870c11dcde94283c87" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-49870c11dcde94283c87">{"x":{"filter":"none","vertical":false,"caption":"<caption>Single SNP MR analysis<\/caption>","data":[["Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes"],["Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7"],["24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G"],["ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7"],[184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305],["rs10190052","rs10507349","rs10811661","rs10830963","rs10842994","rs1111875","rs11257655","rs11717195","rs12571751","rs12970134","rs1359790","rs1535500","rs1552224","rs1561927","rs163184","rs17106184","rs17168486","rs17791513","rs1801282","rs2028299","rs2075423","rs2261181","rs2284219","rs2796441","rs2812533","rs2943640","rs319598","rs3802177","rs3923113","rs4273712","rs4402960","rs4458523","rs4812829","rs516946","rs5215","rs6813195","rs6937795","rs702634","rs7041847","rs7163757","rs7178572","rs7612463","rs7756992","rs7845219","rs7903146","rs8108269","rs849135","rs9472138","rs9502570","rs9936385","All - Inverse variance weighted","All - MR Egger"],[0.5026260613698386,-0.003827083897394029,-0.02956237561512185,0.1951609525613853,0.04447786570295988,0.2065440670716583,0.4296459433688768,0.08302612290756013,0.03641313398796977,0.7180126357991714,0.1220751028262359,0.03699138904285938,0.03278577657481476,0.1210422543870856,-0.006416973580416597,0.5159260018284915,0.1338022970621277,0.02243726750269925,0.007593316002798369,0.3493307208987793,-0.05432618813725068,0.1155571985483539,0.03400275502740355,0.2121384379345809,0.2502414751390225,0.4829091727352931,0.2102677901302791,0.07348739808564492,0.5724781166586592,-0.5125828212660249,0.1141570139185963,0.1202631359628167,0.08930122218356704,0.0412967429930438,0.1206324636848207,0.1759721516246797,0.3842867400471791,0.2076064300752268,-0.03119481202634611,-0.04311046973207983,0.1820011760914782,-0.02395336998300787,0.1197444799392142,0.3075582093299984,0.09834986782952219,0.04631972842630711,0.06390262077409339,-0.1592444461162296,-0.03918041496749133,0.2227338182978805,0.1147545622280697,0.07688428803997334],[0.1833512829450189,0.1892209817376563,0.07439230144062853,0.1007167349232685,0.1410759457527537,0.0670676139777666,0.1879544400711644,0.1337527051983217,0.1087566784540624,0.1343575898578362,0.1126280531842297,0.07535328409427415,0.1052614071573938,0.1815221932337506,0.1121601112770935,0.1727150240802821,0.09305776708718259,0.09022121265172356,0.09518258666506883,0.2646407769138595,0.1301931451560929,0.09529982153503218,0.1937890589415917,0.1414955843184642,0.1928238339707468,0.1209454470776964,0.1908048509054313,0.06905403346289307,0.2620095142033454,0.2109093128743163,0.07938789014095275,0.1144286796947634,0.1686451068323659,0.1163548324299434,0.1232909516285857,0.1306739078829712,0.2383842426184385,0.1788192079698961,0.1904031305928713,0.1601385764797014,0.1262132093927731,0.1371437975128745,0.05515968696650281,0.1204687444859378,0.03087981375324252,0.1755945036455896,0.0861802991320544,0.1809249622040227,0.1744755535554099,0.07842812682869275,0.01885363466619782,0.03902125131072411],[0.006119133235678528,0.9838635073547931,0.691083665213385,0.05265724591484638,0.7525520743451679,0.002072513505212175,0.02225983274618345,0.5347684005400913,0.737766262940738,9.089637047026733e-08,0.2784187621830107,0.6234928415677188,0.7554433019838316,0.5048884340418551,0.9543758270633214,0.002815898278593012,0.1504790994923041,0.803599263167614,0.9364151622766309,0.1868288419997573,0.6764781515803353,0.2252962957821061,0.8607160629047251,0.1338066198332572,0.1943655112442493,6.530176024300793e-05,0.2704597475895757,0.2872374795144206,0.02889239290369336,0.01508437222787877,0.1504439619981833,0.2932642347180731,0.5964436834993174,0.7226489719378723,0.327858096272059,0.1780926533161252,0.106951587624932,0.245647972470107,0.8698605619269133,0.7877701825367862,0.1492985109783038,0.8613477493083344,0.02994104137598433,0.01067956664717474,0.001447919007004774,0.7919432576496224,0.4583908313450628,0.3787680545605656,0.8223207620515013,0.004511725199293967,1.153325073130974e-09,0.05458508583346296]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>exposure<\/th>\n      <th>outcome<\/th>\n      <th>id.exposure<\/th>\n      <th>id.outcome<\/th>\n      <th>samplesize<\/th>\n      <th>SNP<\/th>\n      <th>b<\/th>\n      <th>se<\/th>\n      <th>p<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7,8]},{"name":"exposure","targets":0},{"name":"outcome","targets":1},{"name":"id.exposure","targets":2},{"name":"id.outcome","targets":3},{"name":"samplesize","targets":4},{"name":"SNP","targets":5},{"name":"b","targets":6},{"name":"se","targets":7},{"name":"p","targets":8}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="mr_twosamplemr.html#cb104-1" tabindex="-1"></a>res_loo <span class="ot">&lt;-</span> <span class="fu">mr_leaveoneout</span>(dat)</span>
<span id="cb104-2"><a href="mr_twosamplemr.html#cb104-2" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res_loo, <span class="at">caption =</span> <span class="st">&quot;Leave-one-out MR analysis&quot;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-880205c386583977d7e1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-880205c386583977d7e1">{"x":{"filter":"none","vertical":false,"caption":"<caption>Leave-one-out MR analysis<\/caption>","data":[["Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes"],["Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7","Coronary heart disease || id:ieu-a-7"],["24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G","24wk7G"],["ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7","ieu-a-7"],[184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305,184305],["rs10190052","rs10507349","rs10811661","rs10830963","rs10842994","rs1111875","rs11257655","rs11717195","rs12571751","rs12970134","rs1359790","rs1535500","rs1552224","rs1561927","rs163184","rs17106184","rs17168486","rs17791513","rs1801282","rs2028299","rs2075423","rs2261181","rs2284219","rs2796441","rs2812533","rs2943640","rs319598","rs3802177","rs3923113","rs4273712","rs4402960","rs4458523","rs4812829","rs516946","rs5215","rs6813195","rs6937795","rs702634","rs7041847","rs7163757","rs7178572","rs7612463","rs7756992","rs7845219","rs7903146","rs8108269","rs849135","rs9472138","rs9502570","rs9936385","All"],[0.1123557458181299,0.1154428846547127,0.1203519653916966,0.1130826067182098,0.1154918505244955,0.110334888683606,0.1129018724177598,0.1151253184061371,0.1161475044313049,0.1077693761534084,0.1146333400550639,0.1176913204543996,0.1163122675059071,0.1147148829955006,0.1167781216048462,0.1119563029429262,0.1142889483146467,0.1171591032120114,0.1172557262852915,0.1140604127627741,0.116841185990423,0.1147358756775362,0.1152013377173709,0.1137390007042716,0.1139973883328003,0.1094794804573736,0.1142093619731823,0.1166238029907869,0.1133726586863973,0.1176822931089374,0.1147748176553351,0.1146662385862723,0.1149408410459391,0.1158931019254767,0.1146735587918467,0.1140046933618341,0.1137709204283977,0.1141506452308263,0.1155911969619155,0.1160369133984957,0.1138708100449681,0.1162953612608296,0.1143909881127165,0.1119697634133747,0.1192928039125758,0.1152162783475825,0.1162098370360192,0.1164951726822124,0.1158065858764718,0.1110010639792981,0.1147545622280697],[0.01859046036383561,0.01905940466334833,0.01895934983215237,0.01917162765807706,0.01912017406265943,0.0192737729062205,0.01878228685493137,0.01915351649801336,0.01915732159031615,0.01668116074231411,0.01920559555096856,0.01927774028903022,0.0191585512014571,0.0191088884890763,0.0190717377399053,0.01848907139581005,0.01927552188606314,0.01917214778246848,0.0191211935145711,0.01898779542712389,0.01897108817599434,0.01926947470872903,0.01908184445855883,0.01909364218545017,0.01904583040311857,0.01808383899977305,0.01907472560785665,0.01943248483100935,0.01872813328698421,0.01805867573061307,0.0193691745142755,0.01920085337741621,0.01911598941157426,0.0191499263891955,0.01917956041410795,0.01914005471073514,0.01893794196521765,0.0190800741654802,0.0190364533627086,0.01901475228757116,0.0191410376066067,0.01903664233887142,0.01972975851112892,0.01888805644507006,0.02147717069063867,0.01909582159846921,0.01927857648069084,0.0188459815573659,0.01902493014268978,0.01915049180536873,0.01885363466619782],[1.505902972137933e-09,1.386803962794639e-09,2.182807209754178e-10,3.6696464528474e-09,1.538148287015308e-09,1.036698577764039e-08,1.84288792084093e-09,1.847669950881828e-09,1.337504701090068e-09,1.043271200789183e-10,2.390825602008409e-09,1.027767793602622e-09,1.270871361871155e-09,1.934408858530188e-09,9.177313654546608e-10,1.401831091519044e-09,3.043637445919542e-09,9.907001236255142e-10,8.665086077297444e-10,1.889429939033161e-09,7.324827967118417e-10,2.612169473427018e-09,1.567896198931787e-09,2.570605476770073e-09,2.158256338510765e-09,1.412965331091073e-09,2.131292328678109e-09,1.955187292385856e-09,1.416426163559124e-09,7.188897286151251e-11,3.110773241167402e-09,2.344566770120835e-09,1.823330076043023e-09,1.431629949855965e-09,2.245857852249207e-09,2.579477671268748e-09,1.88330122300077e-09,2.194486025276401e-09,1.262503981931878e-09,1.044431615692769e-09,2.69718720291908e-09,1.002403965827884e-09,6.715409843035648e-09,3.065116269105341e-09,2.785664080998996e-08,1.603607668406346e-09,1.660768082944041e-09,6.352231159473936e-10,1.1497666951935e-09,6.781360524654806e-09,1.153325073130974e-09]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>exposure<\/th>\n      <th>outcome<\/th>\n      <th>id.exposure<\/th>\n      <th>id.outcome<\/th>\n      <th>samplesize<\/th>\n      <th>SNP<\/th>\n      <th>b<\/th>\n      <th>se<\/th>\n      <th>p<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7,8]},{"name":"exposure","targets":0},{"name":"outcome","targets":1},{"name":"id.exposure","targets":2},{"name":"id.outcome","targets":3},{"name":"samplesize","targets":4},{"name":"SNP","targets":5},{"name":"b","targets":6},{"name":"se","targets":7},{"name":"p","targets":8}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<blockquote>
<p>Question: What do the results of the single SNP and leave-one-out analyses tell you?</p>
</blockquote>
</div>
<div id="visualisation" class="section level3 hasAnchor" number="18.5.5">
<h3><span class="header-section-number">18.5.5</span> Visualisation<a href="mr_twosamplemr.html#visualisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is important to present the causal inference graphically.</p>
<p><strong>Scatter plot</strong></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="mr_twosamplemr.html#cb105-1" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">mr</span>(dat)</span>
<span id="cb105-2"><a href="mr_twosamplemr.html#cb105-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mr_scatter_plot</span>(res, dat)</span>
<span id="cb105-3"><a href="mr_twosamplemr.html#cb105-3" tabindex="-1"></a>p1</span></code></pre></div>
<pre><code>## $`24wk7G.ieu-a-7`</code></pre>
<p><img src="05_7_mendelian_randomization_twosamplemr_files/figure-html/MR_visualisation_Scatter-1.png" width="85%" style="display: block; margin: auto;" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      24wk7G    ieu-a-7</code></pre>
<blockquote>
<p>Question: What do you see in the scatter plot? And what can you conclude from this?</p>
</blockquote>
<p><strong>Single SNP plot</strong></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="mr_twosamplemr.html#cb108-1" tabindex="-1"></a>res_single <span class="ot">&lt;-</span> <span class="fu">mr_singlesnp</span>(dat)</span>
<span id="cb108-2"><a href="mr_twosamplemr.html#cb108-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">mr_forest_plot</span>(res_single)</span>
<span id="cb108-3"><a href="mr_twosamplemr.html#cb108-3" tabindex="-1"></a>p2</span></code></pre></div>
<pre><code>## $`24wk7G.ieu-a-7`</code></pre>
<p><img src="05_7_mendelian_randomization_twosamplemr_files/figure-html/MR_visualisation_Single-1.png" width="85%" style="display: block; margin: auto;" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      24wk7G    ieu-a-7</code></pre>
<blockquote>
<p>Question: What do you see in the forest plot? And what can you conclude from this?</p>
</blockquote>
<p><strong>Leave-One-Out plot</strong></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="mr_twosamplemr.html#cb111-1" tabindex="-1"></a>res_loo <span class="ot">&lt;-</span> <span class="fu">mr_leaveoneout</span>(dat)</span>
<span id="cb111-2"><a href="mr_twosamplemr.html#cb111-2" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">mr_leaveoneout_plot</span>(res_loo)</span>
<span id="cb111-3"><a href="mr_twosamplemr.html#cb111-3" tabindex="-1"></a>p3</span></code></pre></div>
<pre><code>## $`24wk7G.ieu-a-7`</code></pre>
<p><img src="05_7_mendelian_randomization_twosamplemr_files/figure-html/MR_visualisation_LOO-1.png" width="85%" style="display: block; margin: auto;" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      24wk7G    ieu-a-7</code></pre>
<blockquote>
<p>Question: what does a leave-one-out ploy tell you? And what can you conclude from this?</p>
</blockquote>
<p><strong>Funnel plot</strong></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="mr_twosamplemr.html#cb114-1" tabindex="-1"></a>res_single <span class="ot">&lt;-</span> <span class="fu">mr_singlesnp</span>(dat)</span>
<span id="cb114-2"><a href="mr_twosamplemr.html#cb114-2" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">mr_funnel_plot</span>(res_single)</span>
<span id="cb114-3"><a href="mr_twosamplemr.html#cb114-3" tabindex="-1"></a>p4</span></code></pre></div>
<pre><code>## $`24wk7G.ieu-a-7`</code></pre>
<p><img src="05_7_mendelian_randomization_twosamplemr_files/figure-html/MR_visualisation_Funnel-1.png" width="85%" style="display: block; margin: auto;" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      24wk7G    ieu-a-7</code></pre>
<blockquote>
<p>Question: Why would yoy use a funnel plot? And what can it tell you?</p>
</blockquote>
<!-- ### Editing the results -->
<!-- You can edit the results to summarize them in a nice table.  -->
<!-- ```{r MR_editing, echo = TRUE, eval = TRUE} -->
<!-- generate_odds_ratios(res) -->
<!-- res <- mr(dat) -->
<!-- het <- mr_heterogeneity(dat) -->
<!-- plt <- mr_pleiotropy_test(dat) -->
<!-- sin <- mr_singlesnp(dat) -->
<!-- all_res <- combine_all_mrresults(res, het, -->
<!--                                plt, sin, -->
<!--                                ao_slc = TRUE, -->
<!--                                Exp=TRUE, -->
<!--                                split.exposure = FALSE, -->
<!--                                split.outcome = TRUE) -->
<!-- head(all_res[,c("Method","outcome","exposure","nsnp","b","se","pval","intercept","intercept_se","intercept_pval","Q","Q_df","Q_pval","consortium","ncase","ncontrol","pmid","population")]) -->
<!-- DT::datatable(all_res) -->
<!-- ``` -->
<blockquote>
<p>Question: What are your main conclusions from the MR analysis?</p>
</blockquote>
</div>
</div>
<div id="the-end-1" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> The end?<a href="mr_twosamplemr.html#the-end-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You are almost at the end. Time to return to the previous chapter on post-GWAS analyses @ref(post_gwas).</p>
<!-- ```{js, echo = FALSE} -->
<!-- title=document.getElementById('header'); -->
<!-- title.innerHTML = '<img src="img/_headers/banner_man_standing_dna.png" alt="TwoSample Mendelian Randomization">' + title.innerHTML -->
<!-- ``` -->

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-hemani2018" class="csl-entry">
Hemani G., et al. 2018. <span>“Evaluating the Potential Role of Pleiotropy in Mendelian Randomization Studies.”</span> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6061876">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6061876</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mr_mrbase.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="epilogue.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": true,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["A-Practical-Primer-in-Human-Complex-Genetics.pdf", "PDF"], ["A-Practical-Primer-in-Human-Complex-Genetics.epub", "EPUB"]],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
