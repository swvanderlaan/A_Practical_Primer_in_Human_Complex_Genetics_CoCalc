<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Mendelian Randomization (MR) | A primer in Human Cardiovascular Genetics</title>
  <meta name="description" content="This is a primer in Human Cardiovascular Genetics. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Mendelian Randomization (MR) | A primer in Human Cardiovascular Genetics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a primer in Human Cardiovascular Genetics. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="swvanderlaan/A_primer_in_Human_Cardiovascular_Genetics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Mendelian Randomization (MR) | A primer in Human Cardiovascular Genetics" />
  
  <meta name="twitter:description" content="This is a primer in Human Cardiovascular Genetics. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="dr. Sander W. van der Laan  " />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prerequisites.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.21/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A primer in Human Cardiovascular Genetics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this primer<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#background-reading"><i class="fa fa-check"></i><b>1.2</b> Background reading<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#meet-the-team"><i class="fa fa-check"></i><b>1.3</b> Meet the Team<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#final-thoughts"><i class="fa fa-check"></i><b>1.4</b> Final thoughts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="prerequisites.html"><a href="prerequisites.html#linux-macos-and-windows"><i class="fa fa-check"></i><b>2.1</b> Linux, macOS, and Windows<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="prerequisites.html"><a href="prerequisites.html#programs-you-need"><i class="fa fa-check"></i><b>2.2</b> Programs you need<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="prerequisites.html"><a href="prerequisites.html#the-terminal"><i class="fa fa-check"></i><b>2.3</b> The Terminal<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prerequisites.html"><a href="prerequisites.html#download-the-data"><i class="fa fa-check"></i><b>2.3.1</b> Download the data<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="prerequisites.html"><a href="prerequisites.html#navigating-the-terminal"><i class="fa fa-check"></i><b>2.3.2</b> Navigating the Terminal<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prerequisites.html"><a href="prerequisites.html#installing-some-r-packages"><i class="fa fa-check"></i><b>2.4</b> Installing some R packages<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="prerequisites.html"><a href="prerequisites.html#are-you-ready"><i class="fa fa-check"></i><b>2.5</b> Are you ready?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html"><i class="fa fa-check"></i><b>3</b> Mendelian Randomization (MR)<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#your-choice"><i class="fa fa-check"></i><b>3.1</b> Your choice<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#mrbase"><i class="fa fa-check"></i><b>3.2</b> MRBase<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#two-sample-mendelian-randomisation"><i class="fa fa-check"></i><b>3.3</b> Two Sample Mendelian Randomisation<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#authentication"><i class="fa fa-check"></i><b>3.3.1</b> Authentication<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#instruments"><i class="fa fa-check"></i><b>3.3.2</b> Instruments<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#clumping"><i class="fa fa-check"></i><b>3.3.3</b> Clumping<span></span></a></li>
<li class="chapter" data-level="3.3.4" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#outcomes"><i class="fa fa-check"></i><b>3.3.4</b> Outcomes<span></span></a></li>
<li class="chapter" data-level="3.3.5" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#harmonisation"><i class="fa fa-check"></i><b>3.3.5</b> Harmonisation<span></span></a></li>
<li class="chapter" data-level="3.3.6" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#mendelian-randomisation"><i class="fa fa-check"></i><b>3.3.6</b> Mendelian randomisation<span></span></a></li>
<li class="chapter" data-level="3.3.7" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#heterogeneity-pleiotropy"><i class="fa fa-check"></i><b>3.3.7</b> Heterogeneity &amp; Pleiotropy<span></span></a></li>
<li class="chapter" data-level="3.3.8" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#visualisation"><i class="fa fa-check"></i><b>3.3.8</b> Visualisation<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>4</b> Summary<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="summary.html"><a href="summary.html#section-1"><i class="fa fa-check"></i><b>4.1</b> Section 1<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="summary.html"><a href="summary.html#section-2"><i class="fa fa-check"></i><b>4.2</b> Section 2<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="summary.html"><a href="summary.html#section-3"><i class="fa fa-check"></i><b>4.3</b> Section 3<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="summary.html"><a href="summary.html#replication"><i class="fa fa-check"></i><b>4.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="epilogue.html"><a href="epilogue.html"><i class="fa fa-check"></i><b>5</b> Epilogue<span></span></a></li>
<li class="chapter" data-level="6" data-path="licenses-and-disclaimers.html"><a href="licenses-and-disclaimers.html"><i class="fa fa-check"></i><b>6</b> Licenses and disclaimers<span></span></a></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A primer in Human Cardiovascular Genetics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mendelian-randomization-mr" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Mendelian Randomization (MR)<a href="mendelian-randomization-mr.html#mendelian-randomization-mr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Finding the causal genes for complex disease is a primary objective of many researchers, because these genes are putative therapeutic targets. In this course we intend to find out whether Type 2 Diabetes (T2D) causes coronary artery disease and ischemic stroke.</p>
<p>There is an easy, quick-and-dirty way and a harder way.</p>
<p><strong>MRBase</strong>
The quick-and-dirty way uses <a href="http://www.mrbase.org/" target="blank">MRBase</a>. It is based on the <code>TwoSampleMR</code> package and uses the <code>MRInstruments</code> package to load in all the genetic instruments. The creators of MRBase have curated hundreds of GWAS and molecular QTL studies, and prepared the data for easy use on the website and in the R packages.</p>
<p><strong>TwoSampleMR</strong>
The hard way means getting your hands dirty and using the <code>TwoSampleMR</code> package yourself in <code>R</code>. You’ll learn all the steps you need to take into account to get to the answer of this question. You’ll create the diagnostic graphs and calculate the statistics.</p>
<div id="your-choice" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Your choice<a href="mendelian-randomization-mr.html#your-choice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Your choice. In both cases you’ll learn how to do execute a MR, what to look out for in the statistics and diagnostic graphs, and how interpret the results. Your choice: Chapter @ref(mendelian_randomization_mr_base) or Chapter @ref(mendelian_randomization_twosamplemr).</p>

</div>
<div id="mrbase" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> MRBase<a href="mendelian-randomization-mr.html#mrbase" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A very easy way is to use <a href="http://www.mrbase.org/" target="blank">MRBase</a>. It is based on the <code>TwoSampleMR</code> package and uses the <code>MRInstruments</code> package to load in all the genetic instruments. The creators of MRBase have curated hundreds of GWAS and molecular QTL studies, and prepared the data for easy use on the website and in the R packages.</p>
<p>In this course we will use this.</p>

</div>
<div id="two-sample-mendelian-randomisation" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Two Sample Mendelian Randomisation<a href="mendelian-randomization-mr.html#two-sample-mendelian-randomisation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also use the <code>TwoSampleMR</code> package for this. Basically the workflow of a MR is as follows, see also the diagram below:</p>
<ol style="list-style-type: decimal">
<li>Select instruments for the exposure (perform LD clumping if necessary)</li>
<li>Extract the instruments from the MR Base GWAS database for the outcomes of interest</li>
<li>Harmonise the effect sizes for the instruments on the exposures and the outcomes to be each for the same reference allele</li>
<li>Perform MR analysis, sensitivity analyses, create plots, compile reports</li>
</ol>
<p><img src="img/twosamplemr.png" /></p>
<p>You need R 3.5.0 or higher to be able to install the packages you need.</p>
<pre><code>install.packages(&quot;remotes&quot;)
remotes::install_github(&quot;MRCIEU/TwoSampleMR&quot;) # to run TwoSampleMR
library(&quot;TwoSampleMR&quot;)

devtools::install_github(&quot;MRCIEU/MRInstruments&quot;)
library(MRInstruments)
</code></pre>
<div id="authentication" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Authentication<a href="mendelian-randomization-mr.html#authentication" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>TwoSampleMR is free use, but it requires server-authentication using a gmail account.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="mendelian-randomization-mr.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TwoSampleMR&quot;</span>)</span></code></pre></div>
<pre><code>## TwoSampleMR version 0.5.6 
## [&gt;] New: Option to use non-European LD reference panels for clumping etc
## [&gt;] Some studies temporarily quarantined to verify effect allele
## [&gt;] See news(package=&#39;TwoSampleMR&#39;) and https://gwas.mrcieu.ac.uk for further details</code></pre>
<pre><code>## 
## Attaching package: &#39;TwoSampleMR&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:remotes&#39;:
## 
##     add_metadata</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="mendelian-randomization-mr.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MRInstruments&quot;</span>)</span>
<span id="cb16-2"><a href="mendelian-randomization-mr.html#cb16-2" aria-hidden="true" tabindex="-1"></a>ao_mr <span class="ot">&lt;-</span> <span class="fu">available_outcomes</span>()</span></code></pre></div>
<pre><code>## API: public: http://gwas-api.mrcieu.ac.uk/</code></pre>
</div>
<div id="instruments" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Instruments<a href="mendelian-randomization-mr.html#instruments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>MRInstruments</code>-package includes several types instruments:</p>
<ul>
<li><em>gwas_catalog</em>, which includes data from GWAS collected by the GWAS Catalog</li>
<li><em>metab_qtls</em>, all known quantitative trait loci (meQTLs) associated to circulating metabolites</li>
<li><em>proteomic_qtls</em>, all known protein QTLs (pQTLs) associated to circulating protein levels</li>
<li><em>gtex_eqtl</em>, all known expression QTLs (eQTLs) associated to gene expression in 53 different tissues from GTEx Portal</li>
<li><em>aries_mqtl</em>, all known methylation QTLs (mQTLs) associated to DNA methylation in blood from ARIES</li>
</ul>
<p>Let’s select T2D associated instruments.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="mendelian-randomization-mr.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gwas_catalog&quot;</span>)</span>
<span id="cb18-2"><a href="mendelian-randomization-mr.html#cb18-2" aria-hidden="true" tabindex="-1"></a>t2d_gwas <span class="ot">&lt;-</span> <span class="fu">subset</span>(gwas_catalog, <span class="fu">grepl</span>(<span class="st">&quot;Mahajan&quot;</span>, Author) <span class="sc">&amp;</span> PubmedID <span class="sc">==</span> <span class="st">&quot;24509480&quot;</span> <span class="sc">&amp;</span> Phenotype <span class="sc">==</span> <span class="st">&quot;Type 2 diabetes&quot;</span>)</span>
<span id="cb18-3"><a href="mendelian-randomization-mr.html#cb18-3" aria-hidden="true" tabindex="-1"></a>t2d_exp_dat <span class="ot">&lt;-</span> <span class="fu">format_data</span>(t2d_gwas)</span></code></pre></div>
<pre><code>## Warning in format_data(t2d_gwas): other_allele column has some values that are
## not A/C/T/G or an indel comprising only these characters or D/I. These SNPs will
## be excluded</code></pre>
<pre><code>## Warning in format_data(t2d_gwas): The following SNP(s) are missing required information for the MR tests and will be excluded
## rs12427353
## rs3923113
## rs4430796
## rs516946
## rs6808574
## rs7612463
## rs7756992
## rs7903146</code></pre>
</div>
<div id="clumping" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Clumping<a href="mendelian-randomization-mr.html#clumping" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Like with identifying independent GWAS hits, it is important for TwoSampleMR to ensure that the instruments for the exposure are independent. We can use MR Base to perform clumping. The European samples from the 1000 genomes project are used to estimate LD between SNPs. You can provide a list of SNP IDs, the SNPs will be extracted from 1000 genomes data, LD calculated between them, and amongst those SNPs that have LD R-square above the specified threshold only the SNP with the lowest P-value will be retained. To do this, use the following command.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="mendelian-randomization-mr.html#cb21-1" aria-hidden="true" tabindex="-1"></a>t2d_exp_dat <span class="ot">&lt;-</span> <span class="fu">clump_data</span>(t2d_exp_dat)</span></code></pre></div>
<pre><code>## Please look at vignettes for options on running this locally if you need to run many instances of this command.</code></pre>
<pre><code>## Clumping X9zvfZ, 62 variants, using EUR population reference</code></pre>
<pre><code>## Removing 8 of 62 variants due to LD with other variants or absence from LD reference panel</code></pre>
</div>
<div id="outcomes" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Outcomes<a href="mendelian-randomization-mr.html#outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Right, so now we are ready to select the proper outcome, CAD. There are multiple datasets available in MRBase, the database used by <code>TwoSampleMR</code>. Let’s review them all and select one with the largest overlap with our exposure SNPs.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="mendelian-randomization-mr.html#cb25-1" aria-hidden="true" tabindex="-1"></a>ao_twosamplemr <span class="ot">&lt;-</span> <span class="fu">available_outcomes</span>()</span>
<span id="cb25-2"><a href="mendelian-randomization-mr.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="mendelian-randomization-mr.html#cb25-3" aria-hidden="true" tabindex="-1"></a>ao_twosamplemr[<span class="fu">grepl</span>(<span class="st">&quot;heart disease&quot;</span>, ao_twosamplemr<span class="sc">$</span>trait), ]</span></code></pre></div>
<pre><code>## # A tibble: 27 × 23
##    id      trait note  ncase group_name  year consortium author sex   population
##    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     
##  1 finn-b… Majo… I9_C… 21012 public      2021 NA         NA     Male… European  
##  2 ieu-a-8 Coro… &lt;NA&gt;  22233 public      2011 CARDIoGRAM Schun… Male… European  
##  3 ukb-e-… I25 … NA     1205 public      2020 NA         Pan-U… Male… South Asi…
##  4 ukb-b-… Diag… 4120…  5738 public      2018 MRC-IEU    Ben E… Male… European  
##  5 ieu-a-9 Coro… &lt;NA&gt;  63746 public      2013 CARDIoGRA… Delou… Male… Mixed     
##  6 ieu-a-6 Coro… &lt;NA&gt;  15420 public      2011 C4D        Peden  Male… Mixed     
##  7 ieu-a-7 Coro… &lt;NA&gt;  60801 public      2015 CARDIoGRA… Nikpay Male… Mixed     
##  8 ukb-d-… Majo… NA    10157 public      2018 NA         Neale… Male… European  
##  9 ukb-a-… Diag… NA     8755 public      2017 Neale Lab  Neale  Male… European  
## 10 ukb-b-… Diag… 4120…  5861 public      2018 MRC-IEU    Ben E… Male… European  
## # … with 17 more rows, and 13 more variables: unit &lt;chr&gt;, nsnp &lt;int&gt;,
## #   sample_size &lt;int&gt;, build &lt;chr&gt;, ncontrol &lt;int&gt;, subcategory &lt;chr&gt;,
## #   category &lt;chr&gt;, ontology &lt;chr&gt;, doi &lt;chr&gt;, mr &lt;int&gt;, priority &lt;int&gt;,
## #   pmid &lt;int&gt;, sd &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="mendelian-randomization-mr.html#cb27-1" aria-hidden="true" tabindex="-1"></a>chd_out_dat <span class="ot">&lt;-</span> <span class="fu">extract_outcome_data</span>(</span>
<span id="cb27-2"><a href="mendelian-randomization-mr.html#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">snps =</span> t2d_exp_dat<span class="sc">$</span>SNP,</span>
<span id="cb27-3"><a href="mendelian-randomization-mr.html#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcomes =</span> <span class="st">&quot;UKB-a:534&quot;</span></span>
<span id="cb27-4"><a href="mendelian-randomization-mr.html#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Deprecated IDs being used? Detected numeric IDs. Trying to fix, but please note the changes below for future.</code></pre>
<pre><code>## UKB-a:534  -&gt;  ukb-a-534</code></pre>
<pre><code>## Extracting data for 54 SNP(s) from 1 GWAS(s)</code></pre>
</div>
<div id="harmonisation" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Harmonisation<a href="mendelian-randomization-mr.html#harmonisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is important to make sure that the effect allele associated to T2D of any given SNP is the same as the effect allele associated CAD. In other words, we need to harmonise the data.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="mendelian-randomization-mr.html#cb31-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">harmonise_data</span>(</span>
<span id="cb31-2"><a href="mendelian-randomization-mr.html#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposure_dat =</span> t2d_exp_dat,</span>
<span id="cb31-3"><a href="mendelian-randomization-mr.html#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome_dat =</span> chd_out_dat</span>
<span id="cb31-4"><a href="mendelian-randomization-mr.html#cb31-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Harmonising Type 2 diabetes (X9zvfZ) and Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534 (ukb-a-534)</code></pre>
<pre><code>## Removing the following SNPs for being palindromic with intermediate allele frequencies:
## rs1727313, rs243088</code></pre>
<!-- ### Drop duplicate datasets -->
<!-- After data harmonisation, users may find that their dataset contains duplicate exposure-outcome summary sets. This can arise, for example, when a GWAS consortium has released multiple results from separate GWAS analyses for the same trait.  -->
<!-- The best thing to do, is to prune the datasets so that only the exposure-outcome combination with the highested expected power is retained.  -->
<!-- In our case we only have 1 dataset for the exposure and 1 for the outcome. But if you don't, you can use the command below. -->
<!-- ```{r MR_powerprune} -->
<!-- dat <- power_prune(dat,  -->
<!--                    method = 1, -->
<!--                    dist.outcome = "binary") -->
<!-- ``` -->
</div>
<div id="mendelian-randomisation" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Mendelian randomisation<a href="mendelian-randomization-mr.html#mendelian-randomisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that the data is harmonised, we are ready to perform a MR and test for a causal relation of T2D with CAD.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="mendelian-randomization-mr.html#cb34-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">mr</span>(dat)</span></code></pre></div>
<pre><code>## Analysing &#39;X9zvfZ&#39; on &#39;ukb-a-534&#39;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="mendelian-randomization-mr.html#cb36-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res, <span class="at">caption =</span> <span class="st">&quot;MR of type 2 diabetes and coronary artery disease&quot;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="htmlwidget-6f74c830b548acfe7fda" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f74c830b548acfe7fda">{"x":{"filter":"none","vertical":false,"caption":"<caption>MR of type 2 diabetes and coronary artery disease<\/caption>","data":[["X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ"],["ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534"],["Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534"],["Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes"],["MR Egger","Weighted median","Inverse variance weighted","Simple mode","Weighted mode"],[51,51,51,51,51],[0.0040962806998675,0.00346293004986617,0.00378199956131184,0.00237387116230173,0.00308809967775673],[0.00145154542394796,0.00098800174646268,0.00069381149793921,0.00180578751112739,0.00113708763542689],[0.00687557724320252,0.00045663518243613,5.00739395245472e-08,0.194645853818907,0.00905419403556476]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>id.exposure<\/th>\n      <th>id.outcome<\/th>\n      <th>outcome<\/th>\n      <th>exposure<\/th>\n      <th>method<\/th>\n      <th>nsnp<\/th>\n      <th>b<\/th>\n      <th>se<\/th>\n      <th>pval<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[5,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Several tests are applied. You can change the method(s) applied by using the <code>method_list</code> flag. Below a list of available methods.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="mendelian-randomization-mr.html#cb37-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">mr_method_list</span>(), <span class="at">caption =</span> <span class="st">&quot;Available MR methods&quot;</span>, row.names</span>
<span id="cb37-2"><a href="mendelian-randomization-mr.html#cb37-2" aria-hidden="true" tabindex="-1"></a> <span class="ot">=</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<caption>(#tab:MR_methods)Available MR methods</caption>
<colgroup>
<col width="15%" />
<col width="30%" />
<col width="4%" />
<col width="31%" />
<col width="7%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">obj</th>
<th align="left">name</th>
<th align="left">PubmedID</th>
<th align="left">Description</th>
<th align="left">use_by_default</th>
<th align="left">heterogeneity_test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mr_wald_ratio</td>
<td align="left">Wald ratio</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_two_sample_ml</td>
<td align="left">Maximum likelihood</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">mr_egger_regression</td>
<td align="left">MR Egger</td>
<td align="left">26050253</td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">mr_egger_regression_bootstrap</td>
<td align="left">MR Egger (bootstrap)</td>
<td align="left">26050253</td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_simple_median</td>
<td align="left">Simple median</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_weighted_median</td>
<td align="left">Weighted median</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_penalised_weighted_median</td>
<td align="left">Penalised weighted median</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_ivw</td>
<td align="left">Inverse variance weighted</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">mr_ivw_radial</td>
<td align="left">IVW radial</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">mr_ivw_mre</td>
<td align="left">Inverse variance weighted (multiplicative random effects)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_ivw_fe</td>
<td align="left">Inverse variance weighted (fixed effects)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_simple_mode</td>
<td align="left">Simple mode</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_weighted_mode</td>
<td align="left">Weighted mode</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_weighted_mode_nome</td>
<td align="left">Weighted mode (NOME)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_simple_mode_nome</td>
<td align="left">Simple mode (NOME)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_raps</td>
<td align="left">Robust adjusted profile score (RAPS)</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">mr_sign</td>
<td align="left">Sign concordance test</td>
<td align="left"></td>
<td align="left">Tests for concordance of signs between exposure and outcome</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">mr_uwr</td>
<td align="left">Unweighted regression</td>
<td align="left"></td>
<td align="left">Doesn’t use any weights</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
</div>
<div id="heterogeneity-pleiotropy" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> Heterogeneity &amp; Pleiotropy<a href="mendelian-randomization-mr.html#heterogeneity-pleiotropy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many genetic variants are associated to multiple traits, thus <em>pleiotropy</em> is common and widespread in the human genome. This poses as an issue to tease apart causal relations in Mendelian randomisation.
<em>Vertical pleiotropy</em> arises because a SNP influences one trait, which in turn influences another. We can use MR to estimate the causal influence between the traits.
<em>Horizontal pleiotropy</em> arises due to SNPs influencing two traits through independent pathways[^4].</p>
<p>Further, we should test for study heterogeneity.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="mendelian-randomization-mr.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mr_heterogeneity</span>(dat)</span></code></pre></div>
<pre><code>##   id.exposure id.outcome
## 1      X9zvfZ  ukb-a-534
## 2      X9zvfZ  ukb-a-534
##                                                                       outcome
## 1 Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534
## 2 Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534
##          exposure                    method       Q Q_df     Q_pval
## 1 Type 2 diabetes                  MR Egger 67.8423   49 0.03851066
## 2 Type 2 diabetes Inverse variance weighted 67.9269   50 0.04653850</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="mendelian-randomization-mr.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mr_pleiotropy_test</span>(dat)</span></code></pre></div>
<pre><code>##   id.exposure id.outcome
## 1      X9zvfZ  ukb-a-534
##                                                                       outcome
## 1 Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534
##          exposure egger_intercept           se      pval
## 1 Type 2 diabetes   -3.691553e-05 0.0001493361 0.8057881</code></pre>
<p>It is also key to inspect the causal effects per SNP and perform a leave-one-out analysis.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="mendelian-randomization-mr.html#cb42-1" aria-hidden="true" tabindex="-1"></a>res_single <span class="ot">&lt;-</span> <span class="fu">mr_singlesnp</span>(dat)</span>
<span id="cb42-2"><a href="mendelian-randomization-mr.html#cb42-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res_single, <span class="at">caption =</span> <span class="st">&quot;Single SNP MR analysis&quot;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="htmlwidget-066f721ac5d9c6d452d8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-066f721ac5d9c6d452d8">{"x":{"filter":"none","vertical":false,"caption":"<caption>Single SNP MR analysis<\/caption>","data":[["Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes"],["Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534"],["X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ"],["ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534"],[337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199],["rs10190052","rs10507349","rs10811661","rs10830963","rs10842994","rs1111875","rs11257655","rs11717195","rs12571751","rs12970134","rs1359790","rs1535500","rs1552224","rs1561927","rs163184","rs17106184","rs17168486","rs17791513","rs1801282","rs2028299","rs2075423","rs2261181","rs2284219","rs2796441","rs2812533","rs2943640","rs3132524","rs319598","rs3802177","rs3923113","rs4273712","rs4402960","rs4458523","rs4812829","rs516946","rs5215","rs6813195","rs6937795","rs702634","rs7041847","rs7163757","rs7178572","rs7612463","rs7756992","rs7845219","rs7903146","rs8108269","rs849135","rs9472138","rs9502570","rs9936385","All - Inverse variance weighted","All - MR Egger"],[0.00701799416202893,0.00655383826975928,0.0032408350892764,0.000923086296036809,0.0132415932401823,0.000521922483047612,0.0227294459882807,0.00475734462491583,0.00382238113071166,0.0097587946955077,0.00188419537523369,0.00753271012929167,0.000218214012213546,-0.00445053817463408,0.00622236406157904,0.00270150576285364,0.00174584464814024,0.0131753502362296,0.000106917527642952,-0.00757716971740318,0.0153577704063199,0.00327862136652149,-0.000762592228031708,-0.000608779526773151,0.00793871902729296,0.0160116835351498,0.00601207693584697,0.019328096472994,0.00279852436111297,0.00820303799022285,-0.0100238851072858,0.00889339758733801,0.0015936141947431,-0.00139712072487797,0.00479166025011818,-0.00609572054996241,-0.00463567013560736,-0.0156349528271823,0.00566168151457529,-0.00899568606647525,0.00688144008373845,0.00154161116129059,-0.0056426711302416,-0.000473416317399841,0.0103112040622781,0.00419464028941228,-0.00207747156927059,0.00799828390794882,0.00231476793272022,0.00332820720764808,0.00022432524169289,0.00378199956131184,0.0040962806998675],[0.00754302681936538,0.00786160260675129,0.00307085596081619,0.00412692541929851,0.00561624435452754,0.00280200026806157,0.00813813087060201,0.00517295100060516,0.00448147278061054,0.00565046929693701,0.00446313290850278,0.00313906423687325,0.00433565916953703,0.00749983162667476,0.00448682219258265,0.00694968786503058,0.00417252395282911,0.00419645625284877,0.00398265718646862,0.0109305253661389,0.00532257612361878,0.00441457335537668,0.00819046229506983,0.00575426806154244,0.00772489566063794,0.00469312847338956,0.00653035509822515,0.00800696219515401,0.00280718222363613,0.010241629172579,0.00893587893014616,0.00339824942393599,0.00456026346887642,0.00778818394819008,0.00474792934950969,0.00521995277181108,0.00573092558895946,0.0100488738809949,0.00716739018193746,0.00789337372718422,0.00668104161436683,0.00552847250659484,0.0064604326763851,0.00239038656571218,0.00500915780645575,0.00125974138091273,0.00736392724378928,0.00339747169004004,0.00725899993011813,0.00740176903748324,0.00322757846971237,0.00069381149793921,0.00145154542394796],[0.352166625332494,0.404477290801146,0.291264201888315,0.823010906771706,0.0183870130432801,0.852234741319233,0.00522287055184732,0.357751623020355,0.393698303155212,0.0841538631865469,0.672901827497513,0.0164099744440318,0.959859364909994,0.552901169838809,0.165500102867962,0.697480827165237,0.675644065032581,0.00169157172620101,0.978582741404563,0.488176612266362,0.00390914469722915,0.457674614400211,0.925818279467187,0.915744074984518,0.30410048503052,0.000645522029569791,0.357240745044448,0.0157823041800362,0.318805373317494,0.423160303857641,0.261965756259697,0.00886926653544695,0.726746543044201,0.857631643523976,0.312873682204741,0.242898292200127,0.418580254740515,0.119734004519823,0.429573132679199,0.254432003196038,0.303012308725295,0.78036041282406,0.38243419182087,0.843005859623255,0.0395449809145371,0.000869199213526549,0.777855619767605,0.0185632665749813,0.749815626840599,0.652962657845079,0.944589527069326,5.00739395245472e-08,0.00687557724320252]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>exposure<\/th>\n      <th>outcome<\/th>\n      <th>id.exposure<\/th>\n      <th>id.outcome<\/th>\n      <th>samplesize<\/th>\n      <th>SNP<\/th>\n      <th>b<\/th>\n      <th>se<\/th>\n      <th>p<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="mendelian-randomization-mr.html#cb43-1" aria-hidden="true" tabindex="-1"></a>res_loo <span class="ot">&lt;-</span> <span class="fu">mr_leaveoneout</span>(dat)</span>
<span id="cb43-2"><a href="mendelian-randomization-mr.html#cb43-2" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(res_loo, <span class="at">caption =</span> <span class="st">&quot;Leave-one-out MR analysis&quot;</span>, <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="htmlwidget-adedd73be725bdc54571" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-adedd73be725bdc54571">{"x":{"filter":"none","vertical":false,"caption":"<caption>Leave-one-out MR analysis<\/caption>","data":[["Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes","Type 2 diabetes"],["Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534","Diagnoses - main ICD10: I25 Chronic ischaemic heart disease || id:ukb-a-534"],["X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ","X9zvfZ"],["ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534","ukb-a-534"],[337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199,337199],["rs10190052","rs10507349","rs10811661","rs10830963","rs10842994","rs1111875","rs11257655","rs11717195","rs12571751","rs12970134","rs1359790","rs1535500","rs1552224","rs1561927","rs163184","rs17106184","rs17168486","rs17791513","rs1801282","rs2028299","rs2075423","rs2261181","rs2284219","rs2796441","rs2812533","rs2943640","rs3132524","rs319598","rs3802177","rs3923113","rs4273712","rs4402960","rs4458523","rs4812829","rs516946","rs5215","rs6813195","rs6937795","rs702634","rs7041847","rs7163757","rs7178572","rs7612463","rs7756992","rs7845219","rs7903146","rs8108269","rs849135","rs9472138","rs9502570","rs9936385","All"],[0.00376172083242628,0.0037660167203777,0.00380312736766689,0.00384274162241619,0.00367452690685115,0.00393608404376505,0.00368008358113336,0.00376891130387615,0.00378127431846496,0.003714925094763,0.0038163694230565,0.00364209594510357,0.00385046586231907,0.00383418945215448,0.00373827754525213,0.00378998503614966,0.00382430092782674,0.00358911663408322,0.00386597342057803,0.00381578780251039,0.00363538284336041,0.00379132130091364,0.00380613133428972,0.0038294942549128,0.00375717034031642,0.00358203869303319,0.00376331507975256,0.00369560151503818,0.00382830306748687,0.00376701420918704,0.00384353599626449,0.00362020100638454,0.00381993268475674,0.00381243217350632,0.00376587608532093,0.00391214212893719,0.00387380414626183,0.00385037246904886,0.00376894448652445,0.00385508232214318,0.0037571986629379,0.00380827732690249,0.00386269646795743,0.00406333184657689,0.00368847651555959,0.00366338020033613,0.00382053831792991,0.00364847230199873,0.00379193270086116,0.00378495359362407,0.00390727124444773,0.00378199956131184],[0.000702088953377578,0.000702225998580468,0.000714235936843267,0.000705702013422949,0.000689779202606288,0.000709702953934797,0.000673957970749978,0.000705355078213438,0.000707120606924602,0.000698883090584553,0.000706214450531574,0.000705982967059635,0.000703960130225676,0.000696769858163737,0.000705536849315832,0.000703314448874264,0.00070683007193577,0.000680844698631746,0.000704258417153003,0.000696278225160686,0.00067995906235545,0.00070724607820546,0.000701110972404967,0.000701576571924835,0.000701436778767489,0.000669706174074065,0.000703175888228055,0.000682908927644537,0.000716485601643177,0.000701075363503568,0.000689907545552192,0.000699524715071698,0.000705683513997356,0.000700606263683615,0.000706190394436204,0.000686359591527734,0.000693262159472234,0.000682450634521928,0.000702926476288295,0.000689087130944056,0.000702529354907943,0.000704090983097692,0.000692639873083728,0.000705425146042348,0.000696845629071189,0.000794426925299824,0.000699850157504442,0.000703491925724867,0.000703010897493294,0.000703113332900059,0.000706454945368161,0.00069381149793921],[8.41958583508748e-08,8.18647638485969e-08,1.01092318626667e-07,5.17253718346334e-08,9.97899506590012e-08,2.92110644249118e-08,4.7504920856936e-08,9.12784393116847e-08,8.92144251528961e-08,1.06354797436605e-07,6.51778770402415e-08,2.48404151279296e-07,4.50743278369544e-08,3.7379337494524e-08,1.16766441397392e-07,7.09498109428752e-08,6.28506004435501e-08,1.35265852684409e-07,4.03245399084157e-08,4.24694032429586e-08,8.96845972939684e-08,8.2908363906478e-08,5.67613837863177e-08,4.80410801169694e-08,8.49002154062932e-08,8.86019251002276e-08,8.70436757946962e-08,6.24786260020047e-08,9.13359482398315e-08,7.73538585570674e-08,2.53152678917022e-08,2.27630888346611e-07,6.19442198315773e-08,5.27985818313837e-08,9.67822992199918e-08,1.1991759455036e-08,2.29976009395779e-08,1.68106148748185e-08,8.24010847176351e-08,2.21287399126985e-08,8.88813628141348e-08,6.34534576815883e-08,2.45018975712936e-08,8.40553190534547e-09,1.20257361888048e-07,4.00063261831971e-06,4.78606853037412e-08,2.14591515843404e-07,6.89652315999458e-08,7.31998259681976e-08,3.1874728943785e-08,5.00739395245472e-08]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>exposure<\/th>\n      <th>outcome<\/th>\n      <th>id.exposure<\/th>\n      <th>id.outcome<\/th>\n      <th>samplesize<\/th>\n      <th>SNP<\/th>\n      <th>b<\/th>\n      <th>se<\/th>\n      <th>p<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7,8]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="visualisation" class="section level3 hasAnchor" number="3.3.8">
<h3><span class="header-section-number">3.3.8</span> Visualisation<a href="mendelian-randomization-mr.html#visualisation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is important to present the causal inference graphically.</p>
<p><em>Scatter plot</em></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="mendelian-randomization-mr.html#cb44-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">mr</span>(dat)</span></code></pre></div>
<pre><code>## Analysing &#39;X9zvfZ&#39; on &#39;ukb-a-534&#39;</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="mendelian-randomization-mr.html#cb46-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mr_scatter_plot</span>(res, dat)</span>
<span id="cb46-2"><a href="mendelian-randomization-mr.html#cb46-2" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<pre><code>## $`X9zvfZ.ukb-a-534`</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/MR_visualisation_Scatter-1.png" width="672" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      X9zvfZ  ukb-a-534</code></pre>
<p><em>Single SNP plot</em></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="mendelian-randomization-mr.html#cb49-1" aria-hidden="true" tabindex="-1"></a>res_single <span class="ot">&lt;-</span> <span class="fu">mr_singlesnp</span>(dat)</span>
<span id="cb49-2"><a href="mendelian-randomization-mr.html#cb49-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">mr_forest_plot</span>(res_single)</span>
<span id="cb49-3"><a href="mendelian-randomization-mr.html#cb49-3" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div>
<pre><code>## $`X9zvfZ.ukb-a-534`</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_errorbarh).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/MR_visualisation_Single-1.png" width="672" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      X9zvfZ  ukb-a-534</code></pre>
<p><em>Leave-One-Out plot</em></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="mendelian-randomization-mr.html#cb54-1" aria-hidden="true" tabindex="-1"></a>res_loo <span class="ot">&lt;-</span> <span class="fu">mr_leaveoneout</span>(dat)</span>
<span id="cb54-2"><a href="mendelian-randomization-mr.html#cb54-2" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">mr_leaveoneout_plot</span>(res_loo)</span>
<span id="cb54-3"><a href="mendelian-randomization-mr.html#cb54-3" aria-hidden="true" tabindex="-1"></a>p3</span></code></pre></div>
<pre><code>## $`X9zvfZ.ukb-a-534`</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_errorbarh).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/MR_visualisation_LOO-1.png" width="672" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      X9zvfZ  ukb-a-534</code></pre>
<p><em>Funnel plot</em></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="mendelian-randomization-mr.html#cb59-1" aria-hidden="true" tabindex="-1"></a>res_single <span class="ot">&lt;-</span> <span class="fu">mr_singlesnp</span>(dat)</span>
<span id="cb59-2"><a href="mendelian-randomization-mr.html#cb59-2" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">mr_funnel_plot</span>(res_single)</span>
<span id="cb59-3"><a href="mendelian-randomization-mr.html#cb59-3" aria-hidden="true" tabindex="-1"></a>p4</span></code></pre></div>
<pre><code>## $`X9zvfZ.ukb-a-534`</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/MR_visualisation_Funnel-1.png" width="672" /></p>
<pre><code>## 
## attr(,&quot;split_type&quot;)
## [1] &quot;data.frame&quot;
## attr(,&quot;split_labels&quot;)
##   id.exposure id.outcome
## 1      X9zvfZ  ukb-a-534</code></pre>
<p><em>Scatter plot</em></p>
<!-- ```{r MR_editing} -->
<!-- generate_odds_ratios(res) -->
<!-- res <- mr(dat) -->
<!-- het <- mr_heterogeneity(dat) -->
<!-- plt <- mr_pleiotropy_test(dat) -->
<!-- sin <- mr_singlesnp(dat) -->
<!-- all_res <- combine_all_mrresults(res, het, -->
<!--                                plt, sin, -->
<!--                                ao_slc = TRUE, -->
<!--                                Exp=TRUE, -->
<!--                                split.exposure = FALSE, -->
<!--                                split.outcome = TRUE) -->
<!-- head(all_res[,c("Method","outcome","exposure","nsnp","b","se","pval","intercept","intercept_se","intercept_pval","Q","Q_df","Q_pval","consortium","ncase","ncontrol","pmid","population")]) -->
<!-- DT::datatable(all_res) -->
<!-- ``` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prerequisites.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/swvanderlaan/A_primer_in_Human_Cardiovascular_Genetics/edit/master/mendelian_randomization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["A primer in Human Cardiovascular Genetics.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
