<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 WTCCC1: a GWAS on coronary artery disease (CAD) | A primer in Human Cardiovascular Genetics</title>
  <meta name="description" content="This is a primer in Human Cardiovascular Genetics. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 WTCCC1: a GWAS on coronary artery disease (CAD) | A primer in Human Cardiovascular Genetics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a primer in Human Cardiovascular Genetics. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="swvanderlaan/A_primer_in_Human_Cardiovascular_Genetics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 WTCCC1: a GWAS on coronary artery disease (CAD) | A primer in Human Cardiovascular Genetics" />
  
  <meta name="twitter:description" content="This is a primer in Human Cardiovascular Genetics. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="dr. Sander W. van der Laan  " />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-welcome-trust-case-control-consortium-wtccc.html"/>
<link rel="next" href="post-gwas-analyses.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A primer in Human Cardiovascular Genetics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this primer<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#background-reading"><i class="fa fa-check"></i><b>1.2</b> Background reading<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#meet-the-team"><i class="fa fa-check"></i><b>1.3</b> Meet the Team<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#final-thoughts"><i class="fa fa-check"></i><b>1.4</b> Final thoughts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="prerequisites.html"><a href="prerequisites.html#linux-macos-and-windows"><i class="fa fa-check"></i><b>2.1</b> Linux, macOS, and Windows<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="prerequisites.html"><a href="prerequisites.html#programs-you-need"><i class="fa fa-check"></i><b>2.2</b> Programs you need<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="prerequisites.html"><a href="prerequisites.html#the-terminal"><i class="fa fa-check"></i><b>2.3</b> The Terminal<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prerequisites.html"><a href="prerequisites.html#download-the-data"><i class="fa fa-check"></i><b>2.3.1</b> Download the data<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="prerequisites.html"><a href="prerequisites.html#navigating-the-terminal"><i class="fa fa-check"></i><b>2.3.2</b> Navigating the Terminal<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prerequisites.html"><a href="prerequisites.html#installing-some-r-packages"><i class="fa fa-check"></i><b>2.4</b> Installing some R packages<span></span></a></li>
<li class="chapter" data-level="2.5" data-path="prerequisites.html"><a href="prerequisites.html#are-you-ready"><i class="fa fa-check"></i><b>2.5</b> Are you ready?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics-of-a-genome-wide-association-study-gwas.html"><a href="basics-of-a-genome-wide-association-study-gwas.html"><i class="fa fa-check"></i><b>3</b> Basics of a Genome-Wide Association Study (GWAS)<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics-of-a-genome-wide-association-study-gwas.html"><a href="basics-of-a-genome-wide-association-study-gwas.html#converting-datasets"><i class="fa fa-check"></i><b>3.1</b> Converting datasets<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="basics-of-a-genome-wide-association-study-gwas.html"><a href="basics-of-a-genome-wide-association-study-gwas.html#quality-control"><i class="fa fa-check"></i><b>3.2</b> Quality control<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="basics-of-a-genome-wide-association-study-gwas.html"><a href="basics-of-a-genome-wide-association-study-gwas.html#lets-get-our-hands-dirty"><i class="fa fa-check"></i><b>3.3</b> Let’s get our hands dirty<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sample-qc.html"><a href="sample-qc.html"><i class="fa fa-check"></i><b>4</b> Sample QC<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="sample-qc.html"><a href="sample-qc.html#sex"><i class="fa fa-check"></i><b>4.1</b> Sex<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="sample-qc.html"><a href="sample-qc.html#sample-callrates"><i class="fa fa-check"></i><b>4.2</b> Sample Callrates<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="sample-qc.html"><a href="sample-qc.html#heterozygosity-rate"><i class="fa fa-check"></i><b>4.3</b> Heterozygosity rate<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="sample-qc.html"><a href="sample-qc.html#relatedness"><i class="fa fa-check"></i><b>4.4</b> Relatedness<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="sample-qc.html"><a href="sample-qc.html#ancestral-background"><i class="fa fa-check"></i><b>4.5</b> Ancestral background<span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="sample-qc.html"><a href="sample-qc.html#hapmap-3"><i class="fa fa-check"></i><b>4.5.1</b> HapMap 3<span></span></a></li>
<li class="chapter" data-level="4.5.2" data-path="sample-qc.html"><a href="sample-qc.html#principal-component-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Principal Component Analysis<span></span></a></li>
<li class="chapter" data-level="4.5.3" data-path="sample-qc.html"><a href="sample-qc.html#g-phase-1"><i class="fa fa-check"></i><b>4.5.3</b> 1000G phase 1<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="sample-qc.html"><a href="sample-qc.html#removing-samples"><i class="fa fa-check"></i><b>4.6</b> Removing samples<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="sample-qc.html"><a href="sample-qc.html#the-next-step"><i class="fa fa-check"></i><b>4.7</b> The next step<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="per-snp-qc.html"><a href="per-snp-qc.html"><i class="fa fa-check"></i><b>5</b> Per-SNP QC<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="per-snp-qc.html"><a href="per-snp-qc.html#snp-call-rates"><i class="fa fa-check"></i><b>5.1</b> SNP call rates<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="per-snp-qc.html"><a href="per-snp-qc.html#differential-snp-call-rates"><i class="fa fa-check"></i><b>5.2</b> Differential SNP call rates<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="per-snp-qc.html"><a href="per-snp-qc.html#allele-frequencies"><i class="fa fa-check"></i><b>5.3</b> Allele frequencies<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="per-snp-qc.html"><a href="per-snp-qc.html#hardy-weinberg-equilibrium"><i class="fa fa-check"></i><b>5.4</b> Hardy-Weinberg Equilibrium<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="per-snp-qc.html"><a href="per-snp-qc.html#final-snp-qc"><i class="fa fa-check"></i><b>5.5</b> Final SNP QC<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="per-snp-qc.html"><a href="per-snp-qc.html#a-milestone"><i class="fa fa-check"></i><b>5.6</b> A Milestone<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="genome-wide-association-study.html"><a href="genome-wide-association-study.html"><i class="fa fa-check"></i><b>6</b> Genome-wide association study<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="genome-wide-association-study.html"><a href="genome-wide-association-study.html#exploring-the-data"><i class="fa fa-check"></i><b>6.1</b> Exploring the data<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="genome-wide-association-study.html"><a href="genome-wide-association-study.html#genetic-models"><i class="fa fa-check"></i><b>6.2</b> Genetic models<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="genome-wide-association-study.html"><a href="genome-wide-association-study.html#logistic-regression"><i class="fa fa-check"></i><b>6.3</b> Logistic regression<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="genome-wide-association-study.html"><a href="genome-wide-association-study.html#lets-get-visual"><i class="fa fa-check"></i><b>6.4</b> Let’s get visual<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html"><i class="fa fa-check"></i><b>7</b> GWAS visualisation<span></span></a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html#qq-plots"><i class="fa fa-check"></i><b>7.0.1</b> QQ plots<span></span></a></li>
<li class="chapter" data-level="7.1" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html#manhattan-plots"><i class="fa fa-check"></i><b>7.1</b> Manhattan plots<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html#other-plots"><i class="fa fa-check"></i><b>7.2</b> Other plots<span></span></a></li>
<li class="chapter" data-level="7.3" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html#interactive-plots"><i class="fa fa-check"></i><b>7.3</b> Interactive plots<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html#regional-association-plots"><i class="fa fa-check"></i><b>7.4</b> Regional association plots<span></span></a></li>
<li class="chapter" data-level="7.5" data-path="gwas-visualisation.html"><a href="gwas-visualisation.html#stop-playing-around"><i class="fa fa-check"></i><b>7.5</b> Stop playing around<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-welcome-trust-case-control-consortium-wtccc.html"><a href="the-welcome-trust-case-control-consortium-wtccc.html"><i class="fa fa-check"></i><b>8</b> The Welcome Trust Case-Control Consortium (WTCCC)<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="the-welcome-trust-case-control-consortium-wtccc.html"><a href="the-welcome-trust-case-control-consortium-wtccc.html#there-you-go"><i class="fa fa-check"></i><b>8.1</b> There you go<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><i class="fa fa-check"></i><b>9</b> WTCCC1: a GWAS on coronary artery disease (CAD)<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#quality-control-1"><i class="fa fa-check"></i><b>9.1</b> Quality control<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#ancestral-background-1"><i class="fa fa-check"></i><b>9.2</b> Ancestral background<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#extreme-cleaning"><i class="fa fa-check"></i><b>9.2.1</b> Extreme cleaning<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#removing-samples-1"><i class="fa fa-check"></i><b>9.2.2</b> Removing samples<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#association-testing"><i class="fa fa-check"></i><b>9.3</b> Association testing<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="wtccc1-a-gwas-on-coronary-artery-disease-cad.html"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#replication"><i class="fa fa-check"></i><b>9.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="post-gwas-analyses.html"><a href="post-gwas-analyses.html"><i class="fa fa-check"></i><b>10</b> Post-GWAS Analyses<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="post-gwas-analyses.html"><a href="post-gwas-analyses.html#replication-1"><i class="fa fa-check"></i><b>10.1</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conditional-analysis.html"><a href="conditional-analysis.html"><i class="fa fa-check"></i><b>11</b> Conditional analysis<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="conditional-analysis.html"><a href="conditional-analysis.html#section-1"><i class="fa fa-check"></i><b>11.1</b> Section 1<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="conditional-analysis.html"><a href="conditional-analysis.html#section-2"><i class="fa fa-check"></i><b>11.2</b> Section 2<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="conditional-analysis.html"><a href="conditional-analysis.html#section-3"><i class="fa fa-check"></i><b>11.3</b> Section 3<span></span></a></li>
<li class="chapter" data-level="11.4" data-path="conditional-analysis.html"><a href="conditional-analysis.html#replication-2"><i class="fa fa-check"></i><b>11.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="statistical-finemapping.html"><a href="statistical-finemapping.html"><i class="fa fa-check"></i><b>12</b> Statistical finemapping<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="statistical-finemapping.html"><a href="statistical-finemapping.html#section-1-1"><i class="fa fa-check"></i><b>12.1</b> Section 1<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="statistical-finemapping.html"><a href="statistical-finemapping.html#section-2-1"><i class="fa fa-check"></i><b>12.2</b> Section 2<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="statistical-finemapping.html"><a href="statistical-finemapping.html#section-3-1"><i class="fa fa-check"></i><b>12.3</b> Section 3<span></span></a></li>
<li class="chapter" data-level="12.4" data-path="statistical-finemapping.html"><a href="statistical-finemapping.html#replication-3"><i class="fa fa-check"></i><b>12.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html"><i class="fa fa-check"></i><b>13</b> Functional Mapping and Annotation of GWAS<span></span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html#assignment"><i class="fa fa-check"></i><b>13.1</b> Assignment<span></span></a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html#tutorial"><i class="fa fa-check"></i><b>13.1.1</b> Tutorial<span></span></a></li>
<li class="chapter" data-level="13.1.2" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html#create-the-input"><i class="fa fa-check"></i><b>13.1.2</b> Create the input<span></span></a></li>
<li class="chapter" data-level="13.1.3" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html#run-fuma---snp-to-gene"><i class="fa fa-check"></i><b>13.1.3</b> Run FUMA - SNP to gene<span></span></a></li>
<li class="chapter" data-level="13.1.4" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html#run-fuma---gene-to-function"><i class="fa fa-check"></i><b>13.1.4</b> Run FUMA - Gene to function<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="functional-mapping-and-annotation-of-gwas.html"><a href="functional-mapping-and-annotation-of-gwas.html#some-closing-thoughts"><i class="fa fa-check"></i><b>13.2</b> Some closing thoughts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="phenome-wide-association-study-phewas.html"><a href="phenome-wide-association-study-phewas.html"><i class="fa fa-check"></i><b>14</b> Phenome-Wide Association Study (PheWAS)<span></span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="phenome-wide-association-study-phewas.html"><a href="phenome-wide-association-study-phewas.html#section-1-2"><i class="fa fa-check"></i><b>14.1</b> Section 1<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="phenome-wide-association-study-phewas.html"><a href="phenome-wide-association-study-phewas.html#section-2-2"><i class="fa fa-check"></i><b>14.2</b> Section 2<span></span></a></li>
<li class="chapter" data-level="14.3" data-path="phenome-wide-association-study-phewas.html"><a href="phenome-wide-association-study-phewas.html#section-3-2"><i class="fa fa-check"></i><b>14.3</b> Section 3<span></span></a></li>
<li class="chapter" data-level="14.4" data-path="phenome-wide-association-study-phewas.html"><a href="phenome-wide-association-study-phewas.html#replication-4"><i class="fa fa-check"></i><b>14.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html"><i class="fa fa-check"></i><b>15</b> Mendelian Randomization (MR)<span></span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#section-1-3"><i class="fa fa-check"></i><b>15.1</b> Section 1<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#section-2-3"><i class="fa fa-check"></i><b>15.2</b> Section 2<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#section-3-3"><i class="fa fa-check"></i><b>15.3</b> Section 3<span></span></a></li>
<li class="chapter" data-level="15.4" data-path="mendelian-randomization-mr.html"><a href="mendelian-randomization-mr.html#replication-5"><i class="fa fa-check"></i><b>15.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mendelian-randomization-mr-1.html"><a href="mendelian-randomization-mr-1.html"><i class="fa fa-check"></i><b>16</b> Mendelian Randomization (MR)<span></span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="mendelian-randomization-mr-1.html"><a href="mendelian-randomization-mr-1.html#section-1-4"><i class="fa fa-check"></i><b>16.1</b> Section 1<span></span></a></li>
<li class="chapter" data-level="16.2" data-path="mendelian-randomization-mr-1.html"><a href="mendelian-randomization-mr-1.html#section-2-4"><i class="fa fa-check"></i><b>16.2</b> Section 2<span></span></a></li>
<li class="chapter" data-level="16.3" data-path="mendelian-randomization-mr-1.html"><a href="mendelian-randomization-mr-1.html#section-3-4"><i class="fa fa-check"></i><b>16.3</b> Section 3<span></span></a></li>
<li class="chapter" data-level="16.4" data-path="mendelian-randomization-mr-1.html"><a href="mendelian-randomization-mr-1.html#replication-6"><i class="fa fa-check"></i><b>16.4</b> Replication!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="license-your-gitbook.html"><a href="license-your-gitbook.html"><i class="fa fa-check"></i><b>17</b> License your GitBook<span></span></a></li>
<li class="chapter" data-level="18" data-path="license-your-gitbook-1.html"><a href="license-your-gitbook-1.html"><i class="fa fa-check"></i><b>18</b> License your GitBook<span></span></a></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A primer in Human Cardiovascular Genetics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wtccc1-a-gwas-on-coronary-artery-disease-cad" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> WTCCC1: a GWAS on coronary artery disease (CAD)<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#wtccc1-a-gwas-on-coronary-artery-disease-cad" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>As usual, we start by exploring the data in hand.</p>
<pre><code>plink --bfile wtccc1/CADn1871_500Kb37fwd --bmerge wtccc1/UKBSn1397_500Kb37fwd --make-bed --out wtccc1/wtccc1 &amp;&amp; \
plink --bfile wtccc1/wtccc1 --freq --out wtccc1/wtccc1 &amp;&amp; \
plink --bfile wtccc1/wtccc1 --hardy --out wtccc1/wtccc1 &amp;&amp; \
plink --bfile wtccc1/wtccc1 --missing --out wtccc1/wtccc1 &amp;&amp; \
plink --bfile wtccc1/wtccc1 --test-missing --out wtccc1/wtccc1

cat wtccc1/wtccc1.missing | awk &#39;$5 &lt; 0.00001&#39; | awk &#39;{ print $2 }&#39; &gt; wtccc1/wtccc1-fail-diffmiss-qc.txt</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb124-1" aria-hidden="true" tabindex="-1"></a>wtccc1_HWE <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(COURSE_loc, <span class="st">&quot;/wtccc1/wtccc1.hwe&quot;</span>))</span>
<span id="cb124-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb124-2" aria-hidden="true" tabindex="-1"></a>wtccc1_FRQ <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(COURSE_loc, <span class="st">&quot;/wtccc1/wtccc1.frq&quot;</span>))</span>
<span id="cb124-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb124-3" aria-hidden="true" tabindex="-1"></a>wtccc1_IMISS <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(COURSE_loc, <span class="st">&quot;/wtccc1/wtccc1.imiss&quot;</span>))</span>
<span id="cb124-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb124-4" aria-hidden="true" tabindex="-1"></a>wtccc1_LMISS <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(COURSE_loc, <span class="st">&quot;/wtccc1/wtccc1.lmiss&quot;</span>))</span>
<span id="cb124-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb124-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb124-6" aria-hidden="true" tabindex="-1"></a>wtccc1_HWE<span class="sc">$</span>logP <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log10</span>(wtccc1_HWE<span class="sc">$</span>P)</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">gghistogram</span>(wtccc1_HWE, <span class="at">x =</span> <span class="st">&quot;logP&quot;</span>,</span>
<span id="cb125-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb125-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;#595A5C&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb125-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb125-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-5" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># color = &quot;#1290D9&quot;, fill = &quot;#1290D9&quot;,</span></span>
<span id="cb125-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">&quot;TEST&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;TEST&quot;</span>,</span>
<span id="cb125-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">palette =</span> <span class="st">&quot;lancet&quot;</span>,</span>
<span id="cb125-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">facet.by =</span> <span class="st">&quot;TEST&quot;</span>,</span>
<span id="cb125-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bins =</span> <span class="dv">50</span>,</span>
<span id="cb125-10"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlab =</span> <span class="st">&quot;HWE -log10(P)&quot;</span>) <span class="sc">+</span></span>
<span id="cb125-11"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb125-12"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb125-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;#E55738&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1%20HWE-1.png" width="672" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-1" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">gghistogram</span>(wtccc1_FRQ, <span class="at">x =</span> <span class="st">&quot;MAF&quot;</span>,</span>
<span id="cb126-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;#595A5C&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb126-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rug =</span> <span class="cn">TRUE</span>,</span>
<span id="cb126-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">&quot;#1290D9&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#1290D9&quot;</span>,</span>
<span id="cb126-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlab =</span> <span class="st">&quot;minor allele frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb126-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.05</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb126-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb126-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;#E55738&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: Using `bins = 30` by default. Pick better value with the argument
## `bins`.</code></pre>
<pre><code>## Warning: geom_vline(): Ignoring `mapping` because `xintercept` was provided.</code></pre>
<pre><code>## Warning: geom_vline(): Ignoring `data` because `xintercept` was provided.</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1%20FREQ-1.png" width="672" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-1" aria-hidden="true" tabindex="-1"></a>wtccc1_IMISS<span class="sc">$</span>callrate <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> wtccc1_IMISS<span class="sc">$</span>F_MISS</span>
<span id="cb130-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-3" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">gghistogram</span>(wtccc1_IMISS, <span class="at">x =</span> <span class="st">&quot;callrate&quot;</span>,</span>
<span id="cb130-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;#595A5C&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb130-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rug =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">50</span>,</span>
<span id="cb130-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">&quot;#1290D9&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#1290D9&quot;</span>,</span>
<span id="cb130-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlab =</span> <span class="st">&quot;per sample call rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.95</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb130-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb130-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;#E55738&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: geom_vline(): Ignoring `mapping` because `xintercept` was provided.</code></pre>
<pre><code>## Warning: geom_vline(): Ignoring `data` because `xintercept` was provided.</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1%20callrate%20samples-1.png" width="672" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-1" aria-hidden="true" tabindex="-1"></a>wtccc1_LMISS<span class="sc">$</span>callrate <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> wtccc1_LMISS<span class="sc">$</span>F_MISS</span>
<span id="cb133-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-3" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">gghistogram</span>(wtccc1_LMISS, <span class="at">x =</span> <span class="st">&quot;callrate&quot;</span>,</span>
<span id="cb133-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;#595A5C&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb133-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">rug =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">50</span>,</span>
<span id="cb133-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">&quot;#1290D9&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#1290D9&quot;</span>,</span>
<span id="cb133-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlab =</span> <span class="st">&quot;per SNP call rate&quot;</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.95</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb133-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb133-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;#E55738&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning: geom_vline(): Ignoring `mapping` because `xintercept` was provided.</code></pre>
<pre><code>## Warning: geom_vline(): Ignoring `data` because `xintercept` was provided.</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1%20callrate%20SNPs-1.png" width="672" /></p>
<div id="quality-control-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Quality control<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#quality-control-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have handle on the data, we can filter it.</p>
<blockquote>
<p>Do you have any thoughts on that? Do you agree with the filters I set below? How would you do it differently and why?</p>
</blockquote>
<pre><code>plink --bfile wtccc1/wtccc1 --exclude wtccc1/wtccc1-fail-diffmiss-qc.txt --maf 0.01 --geno 0.05 --hwe 0.00001 --make-bed --out wtccc1/wtccc1_clean</code></pre>
</div>
<div id="ancestral-background-1" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Ancestral background<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#ancestral-background-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If these individuals are all from the United Kingdom, we are certain there will be admixture from other populations given UK’s history. Let’s project the WTCCC1 data on 1000G phase 1 populations.</p>
<div id="extreme-cleaning" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Extreme cleaning<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#extreme-cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For PCA we need to perform extreme clean.</p>
<pre><code>plink --bfile wtccc1/wtccc1_clean --maf 0.1 --geno 0.1 --indep-pairwise 100 50 0.2 --exclude rawdata/exclude_problematic_range.txt --make-bed --out wtccc1/wtccc1_temp

plink --bfile wtccc1/wtccc1_temp --exclude wtccc1/wtccc1_temp.prune.out --make-bed --out wtccc1/wtccc1_extrclean

rm -v wtccc1/wtccc1_temp*

cat wtccc1/wtccc1_extrclean.bim | awk &#39;{ print $2 }&#39; &gt; wtccc1/wtccc1_extrclean.variants.txt

cat wtccc1/wtccc1.bim | grep &quot;rs&quot; &gt; wtccc1/all.variants.txt

plink --bfile reference/1kg_phase1_all/1kg_phase1_all --extract wtccc1/all.variants.txt --make-bed --out reference/1kg_phase1_all/1kg_phase1_wtccc1

cat reference/1kg_phase1_all/1kg_phase1_wtccc1.bim | \
awk &#39;($5 == &quot;A&quot; &amp;&amp; $6 == &quot;T&quot;) || ($5 == &quot;T&quot; &amp;&amp; $6 == &quot;A&quot;) || ($5 == &quot;C&quot; &amp;&amp; $6 == &quot;G&quot;) || ($5 == &quot;G&quot; &amp;&amp; $6 == &quot;C&quot;)&#39; | awk &#39;{ print $2, $1, $4, $3, $5, $6 }&#39; \
&gt; reference/1kg_phase1_all/all.1kg_wtccc1.atcg.variants.txt


plink --bfile reference/1kg_phase1_all/1kg_phase1_wtccc1 --exclude reference/1kg_phase1_all/all.1kg_wtccc1.atcg.variants.txt --make-bed --out reference/1kg_phase1_all/1kg_phase1_wtccc1_no_atcg

plink --bfile reference/1kg_phase1_all/1kg_phase1_wtccc1_no_atcg --extract wtccc1/wtccc1_extrclean.variants.txt --make-bed --out reference/1kg_phase1_all/1kg_phase1_raw_no_atcg_wtccc1

plink --bfile wtccc1/wtccc1_extrclean --bmerge reference/1kg_phase1_all/1kg_phase1_raw_no_atcg_wtccc1 --maf 0.1 --geno 0.1 --exclude rawdata/exclude_problematic_range.txt --make-bed --out wtccc1/wtccc1_extrclean_1kg</code></pre>
<pre><code>cp -v wtccc1/wtccc1_extrclean_1kg.bim wtccc1/wtccc1_extrclean_1kg.pedsnp
cp -v wtccc1/wtccc1_extrclean_1kg.fam wtccc1/wtccc1_extrclean_1kg.pedind</code></pre>
<p>Now that the cleaning is done, we can execute the actual PCA.</p>
<pre><code>perl ~/git/EIG/bin/smartpca.perl \
-i wtccc1/wtccc1_extrclean_1kg.bed \
-a wtccc1/wtccc1_extrclean_1kg.pedsnp \
-b wtccc1/wtccc1_extrclean_1kg.pedind \
-k 10 \
-o wtccc1/wtccc1_extrclean_1kg.pca \
-p wtccc1/wtccc1_extrclean_1kg.plot \
-e wtccc1/wtccc1_extrclean_1kg.eval \
-l wtccc1/wtccc1_extrclean_1kg.log \
-m 5 \
-t 10 \
-s 6.0 \
-w reference/1kg_phase1_all/1kg-pca-populations.txt</code></pre>
<!-- I get an error when I run this. No clue why - but it's a segmentation fault.  -->
<!-- perl /Users/swvanderlaan/git/EIG/bin/smartpca.perl \ -->
<!-- > -i wtccc1/wtccc1_extrclean_1kg.bed \ -->
<!-- > -a wtccc1/wtccc1_extrclean_1kg.pedsnp \ -->
<!-- > -b wtccc1/wtccc1_extrclean_1kg.pedind \ -->
<!-- > -k 10 \ -->
<!-- > -o wtccc1/wtccc1_extrclean_1kg.pca \ -->
<!-- > -p wtccc1/wtccc1_extrclean_1kg.plot \ -->
<!-- > -e wtccc1/wtccc1_extrclean_1kg.eval \ -->
<!-- > -l wtccc1/wtccc1_extrclean_1kg.log \ -->
<!-- > -m 5 \ -->
<!-- > -t 10 \ -->
<!-- > -s 6.0 \ -->
<!-- > -w reference/1kg_phase1_all/1kg-pca-populations.txt -->
<!-- smartpca -p wtccc1/wtccc1_extrclean_1kg.pca.par >wtccc1/wtccc1_extrclean_1kg.log -->
<!-- sh: line 1: 57065 Segmentation fault: 11  smartpca -p wtccc1/wtccc1_extrclean_1kg.pca.par > wtccc1/wtccc1_extrclean_1kg.log -->
<!-- ploteig -i wtccc1/wtccc1_extrclean_1kg.pca.evec -c 1:2  -p   -x  -y  -o wtccc1/wtccc1_extrclean_1kg.plot.xtxt -->
<!-- evec2pca.perl 10 wtccc1/wtccc1_extrclean_1kg.pca.evec wtccc1/wtccc1_extrclean_1kg.pedind wtccc1/wtccc1_extrclean_1kg.pca -->
<p>And we should visualize the PCA results: are these individuals really all from European (UK) ancestry?</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-1" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(COURSE_loc,<span class="st">&quot;/wtccc1/wtccc1_extrclean_1kg.pca.evec&quot;</span>), <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">skip =</span> <span class="dv">1</span>)</span>
<span id="cb140-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Population    Description Super population    Code    Counts</span></span>
<span id="cb140-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ASW   African Ancestry in Southwest US                              AFR   4     #49A01D</span></span>
<span id="cb140-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co"># CEU   Utah residents with Northern and Western European ancestry  EUR 7     #E55738</span></span>
<span id="cb140-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co"># CHB   Han Chinese in Bejing, China                                  EAS   8     #9A3480</span></span>
<span id="cb140-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co"># CHS   Southern Han Chinese, China                                 EAS 9     #705296</span></span>
<span id="cb140-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co"># CLM   Colombian in Medellin, Colombia                             MR  10    #8D5B9A</span></span>
<span id="cb140-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co"># FIN   Finnish in Finland                                          EUR 12  #2F8BC9</span></span>
<span id="cb140-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GBR   British in England and Scotland                             EUR 13  #1290D9</span></span>
<span id="cb140-10"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="co"># IBS   Iberian populations in Spain                                  EUR   16  #1396D8</span></span>
<span id="cb140-11"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="co"># JPT   Japanese in Tokyo, Japan                                      EAS   18  #D5267B</span></span>
<span id="cb140-12"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="co"># LWK   Luhya in Webuye, Kenya                                      AFR 20  #78B113</span></span>
<span id="cb140-13"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MXL   Mexican Ancestry in Los Angeles, California                 AMR 22  #F59D10</span></span>
<span id="cb140-14"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-14" aria-hidden="true" tabindex="-1"></a><span class="co"># PUR   Puerto Rican in Puerto Rico                                 AMR 25  #FBB820</span></span>
<span id="cb140-15"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-15" aria-hidden="true" tabindex="-1"></a><span class="co"># TSI   Toscani in Italy                                              EUR   27  #4C81BF</span></span>
<span id="cb140-16"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-16" aria-hidden="true" tabindex="-1"></a><span class="co"># YRI   Yoruba in Ibadan, Nigeria                                     AFR   28  #C5D220</span></span>
<span id="cb140-17"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-18"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-18" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;2&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CAD&quot;</span></span>
<span id="cb140-19"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-19" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;UKBS&quot;</span></span>
<span id="cb140-20"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-20" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;4&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;ASW&quot;</span></span>
<span id="cb140-21"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-21" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;7&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CEU&quot;</span></span>
<span id="cb140-22"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-22" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;8&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CHB&quot;</span></span>
<span id="cb140-23"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-23" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;9&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CHS&quot;</span></span>
<span id="cb140-24"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-24" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;10&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CLM&quot;</span></span>
<span id="cb140-25"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-25" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;12&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;FIN&quot;</span></span>
<span id="cb140-26"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-26" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;13&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;GBR&quot;</span></span>
<span id="cb140-27"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-27" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;16&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;IBS&quot;</span></span>
<span id="cb140-28"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-28" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;18&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;JPT&quot;</span></span>
<span id="cb140-29"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-29" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;20&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;LWK&quot;</span></span>
<span id="cb140-30"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-30" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;22&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;MXL&quot;</span></span>
<span id="cb140-31"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-31" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;25&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;PUR&quot;</span></span>
<span id="cb140-32"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-32" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;27&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;TSI&quot;</span></span>
<span id="cb140-33"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-33" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kG<span class="sc">$</span>V12[PCA_WTCCC1_1kG<span class="sc">$</span>V12 <span class="sc">==</span> <span class="st">&quot;28&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;YRI&quot;</span></span>
<span id="cb140-34"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-35"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-35" aria-hidden="true" tabindex="-1"></a>PCA_WTCCC1_1kGplot <span class="ot">&lt;-</span> ggpubr<span class="sc">::</span><span class="fu">ggscatter</span>(PCA_WTCCC1_1kG, <span class="at">x =</span> <span class="st">&quot;V2&quot;</span>, <span class="at">y =</span> <span class="st">&quot;V3&quot;</span>,</span>
<span id="cb140-36"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-36" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">color =</span> <span class="st">&quot;V12&quot;</span>,</span>
<span id="cb140-37"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-37" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#49A01D&quot;</span>, <span class="st">&quot;#595A5C&quot;</span>, <span class="st">&quot;#E55738&quot;</span>, <span class="st">&quot;#9A3480&quot;</span>, <span class="st">&quot;#705296&quot;</span>, </span>
<span id="cb140-38"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-38" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;#8D5B9A&quot;</span>, <span class="st">&quot;#2F8BC9&quot;</span>, <span class="st">&quot;#1290D9&quot;</span>, <span class="st">&quot;#1396D8&quot;</span>, <span class="st">&quot;#D5267B&quot;</span>, </span>
<span id="cb140-39"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-39" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">&quot;#78B113&quot;</span>, <span class="st">&quot;#F59D10&quot;</span>, <span class="st">&quot;#FBB820&quot;</span>, <span class="st">&quot;#4C81BF&quot;</span>, <span class="st">&quot;#595A5C&quot;</span>, <span class="st">&quot;#C5D220&quot;</span>),</span>
<span id="cb140-40"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-40" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">xlab =</span> <span class="st">&quot;principal component 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;principal component 2&quot;</span>) <span class="sc">+</span></span>
<span id="cb140-41"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.023</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>,</span>
<span id="cb140-42"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;#595A5C&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb140-43"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-44"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-44" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">ggpar</span>(PCA_WTCCC1_1kGplot,</span>
<span id="cb140-45"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-45" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="st">&quot;Principal Component Analysis&quot;</span>,</span>
<span id="cb140-46"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">subtitle =</span> <span class="st">&quot;Reference population: 1000 G, phase 1&quot;</span>,</span>
<span id="cb140-47"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb140-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.title =</span> <span class="st">&quot;Populations&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/PlotPCA_WTCCC1_1kG-1.png" width="672" /></p>
</div>
<div id="removing-samples-1" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Removing samples<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#removing-samples-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a similar fashion as in the example <em>gwas</em> and <em>rawdata</em> datasets, you should consider to <strong>remove the samples below the threshold</strong> based on this PCA.</p>
<blockquote>
<p>Go ahead, try that.</p>
</blockquote>
<p>You’re code would be something like below:</p>
<pre><code>cat wtccc1/wtccc1_extrclean_1kg.pca.evec | tail -n +2 | \
awk &#39;$3 &lt; 0.023&#39; | awk &#39;{ print $1 }&#39; | awk -F&quot;:&quot; &#39;{ print $1, $2 }&#39; &gt; wtccc1/fail-ancestry-QC.txt</code></pre>
<pre><code>plink --bfile wtccc1/wtccc1_clean --exclude wtccc1/fail-ancestry-QC.txt --make-bed --out wtccc1/wtccc1_qc</code></pre>
</div>
</div>
<div id="association-testing" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Association testing<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#association-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have explored the data, we are ready for some simple association testing. However, it would be great to have some PCs to correct for. We can use PLINK for that too.</p>
<pre><code>plink --bfile wtccc1/wtccc1_extrclean --exclude wtccc1/fail-ancestry-QC.txt --pca --out wtccc1/wtccc1_extrclean</code></pre>
<p>Let’s add those PCs to the covariates-file.</p>
<pre><code>echo &quot;IID PC1 PC2 PC3 PC4 PC5 PC6 PC7 PC8 PC9 PC10 PC11 PC12 PC13 PC14 PC15 PC16 PC17 PC18 PC19 PC20&quot; &gt; wtccc1/wtccc1_qc.pca

cat wtccc1/wtccc1_extrclean.eigenvec | awk &#39;{ print $2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22}&#39; &gt;&gt; wtccc1/wtccc1_qc.pca

perl scripts/mergeTables.pl --file1 wtccc1/wtccc1_qc.pca --file2 wtccc1/wtccc1.covar --index IID --format NORM &gt; wtccc1/wtccc1_qc.covar_pca</code></pre>
<p>Exciting, now we are ready to perform a GWAS on CAD in WTCCC1.</p>
<pre><code>plink --bfile wtccc1/wtccc1_qc --logistic sex --covar wtccc1/wtccc1_qc.covar_pca --out wtccc1/wtccc1_qc_log_covar_pca</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb146-1" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(<span class="fu">paste0</span>(COURSE_loc, <span class="st">&quot;/wtccc1/wtccc1_qc_log_covar_pca.assoc.logistic&quot;</span>))</span>
<span id="cb146-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wtccc1_assoc)</span></code></pre></div>
<pre><code>## [1] 8726361       9</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb148-1" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span></code></pre></div>
<pre><code>##    CHR       SNP     BP A1            TEST NMISS        OR     STAT          P
## 1:   1 rs3094315 752566  G             ADD  3256 1.036e+00  0.37270  7.094e-01
## 2:   1 rs3094315 752566  G age_recruitment  3256 4.351e+00 25.96000 1.471e-148
## 3:   1 rs3094315 752566  G             PC1  3256 1.909e+01  1.11300  2.657e-01
## 4:   1 rs3094315 752566  G             PC2  3256 1.009e-01 -0.87060  3.840e-01
## 5:   1 rs3094315 752566  G             PC3  3256 1.842e-01 -0.62560  5.316e-01
## 6:   1 rs3094315 752566  G             PC4  3256 7.391e-01 -0.11110  9.116e-01
## 7:   1 rs3094315 752566  G             PC5  3256 1.817e-01 -0.63400  5.261e-01
## 8:   1 rs3094315 752566  G             PC6  3256 9.170e-01 -0.03229  9.742e-01
## 9:   1 rs3094315 752566  G             PC7  3256 1.839e+04  3.61000  3.057e-04</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-1" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(wtccc1_assoc, TEST <span class="sc">==</span> <span class="st">&quot;ADD&quot;</span>)</span>
<span id="cb150-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-2" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_sub<span class="sc">$</span>TEST <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb150-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-4" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(wtccc1_FRQ, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;MAF&quot;</span>, <span class="st">&quot;NCHROBS&quot;</span>))</span>
<span id="cb150-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-6" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_subfrq <span class="ot">&lt;-</span> <span class="fu">merge</span>(wtccc1_assoc_sub, temp, <span class="at">by =</span> <span class="st">&quot;SNP&quot;</span>)</span>
<span id="cb150-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-8" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(wtccc1_LMISS, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;callrate&quot;</span>))</span>
<span id="cb150-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-10"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-10" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_subfrqlmiss <span class="ot">&lt;-</span> <span class="fu">merge</span>(wtccc1_assoc_subfrq, temp, <span class="at">by =</span> <span class="st">&quot;SNP&quot;</span>)</span>
<span id="cb150-11"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wtccc1_assoc_subfrqlmiss)</span></code></pre></div>
<pre><code>##           SNP CHR        BP A1 NMISS     OR     STAT      P A2    MAF NCHROBS
## 1: rs10000012   4   1357325  G  3265 1.0480  0.48180 0.6299  C 0.1345    6530
## 2:  rs1000002   3 183635768  T  3264 1.1100  1.55000 0.1212  C 0.4827    6528
## 3:  rs1000003   3  98342907  G  3232 1.0080  0.08926 0.9289  A 0.1454    6464
## 4: rs10000033   4 139599898  C  3266 1.0070  0.10840 0.9137  T 0.4545    6532
## 5: rs10000037   4  38924330  A  3267 1.1100  1.35900 0.1741  G 0.2557    6534
## 6: rs10000062   4   5254744  C  3266 0.8589 -1.59000 0.1119  G 0.1408    6532
##    callrate
## 1: 0.999082
## 2: 0.998776
## 3: 0.988980
## 4: 0.999388
## 5: 0.999694
## 6: 0.999388</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember:</span></span>
<span id="cb152-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - that z = beta/se</span></span>
<span id="cb152-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - beta = log(OR), because log is the natural log in r</span></span>
<span id="cb152-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-5" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_subfrqlmiss<span class="sc">$</span>BETA <span class="ot">=</span> <span class="fu">log</span>(wtccc1_assoc_subfrqlmiss<span class="sc">$</span>OR)</span>
<span id="cb152-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-6" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_subfrqlmiss<span class="sc">$</span>SE <span class="ot">=</span> wtccc1_assoc_subfrqlmiss<span class="sc">$</span>BETA<span class="sc">/</span>wtccc1_assoc_subfrqlmiss<span class="sc">$</span>STAT</span>
<span id="cb152-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-9" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_subfrqlmiss_tib <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">as_tibble</span>(wtccc1_assoc_subfrqlmiss)</span>
<span id="cb152-10"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-11"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-11" aria-hidden="true" tabindex="-1"></a>col_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;CHR&quot;</span>, <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb152-12"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;MAF&quot;</span>, <span class="st">&quot;callrate&quot;</span>, <span class="st">&quot;NMISS&quot;</span>, <span class="st">&quot;NCHROBS&quot;</span>,</span>
<span id="cb152-13"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;BETA&quot;</span>, <span class="st">&quot;SE&quot;</span>, <span class="st">&quot;OR&quot;</span>, <span class="st">&quot;STAT&quot;</span>, <span class="st">&quot;P&quot;</span>)</span>
<span id="cb152-14"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-14" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_compl <span class="ot">&lt;-</span> wtccc1_assoc_subfrqlmiss_tib[, col_order]</span>
<span id="cb152-15"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-16"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(wtccc1_assoc_compl)</span></code></pre></div>
<pre><code>## [1] 379407     14</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wtccc1_assoc_compl)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 14
##   SNP        CHR     BP A1    A2      MAF callrate NMISS NCHROBS     BETA     SE
##   &lt;chr&gt;    &lt;int&gt;  &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;   &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1 rs10000…     4 1.36e6 G     C     0.134    0.999  3265    6530  0.0469  0.0973
## 2 rs10000…     3 1.84e8 T     C     0.483    0.999  3264    6528  0.104   0.0673
## 3 rs10000…     3 9.83e7 G     A     0.145    0.989  3232    6464  0.00797 0.0893
## 4 rs10000…     4 1.40e8 C     T     0.454    0.999  3266    6532  0.00698 0.0644
## 5 rs10000…     4 3.89e7 A     G     0.256    1.00   3267    6534  0.104   0.0768
## 6 rs10000…     4 5.25e6 C     G     0.141    0.999  3266    6532 -0.152   0.0957
## # … with 3 more variables: OR &lt;dbl&gt;, STAT &lt;dbl&gt;, P &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb156-1" aria-hidden="true" tabindex="-1"></a>wtccc1_assoc_complsub <span class="ot">&lt;-</span> <span class="fu">subset</span>(wtccc1_assoc_compl, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;CHR&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;P&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CMplot(wtccc1_assoc_complsub,</span></span>
<span id="cb157-2"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co">#        plot.type = &quot;d&quot;,</span></span>
<span id="cb157-3"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co">#        bin.size = 1e6, col = c(&quot;darkgreen&quot;, &quot;yellow&quot;, &quot;red&quot;),</span></span>
<span id="cb157-4"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co">#        file = &quot;jpg&quot;, memo = &quot;&quot;, dpi = 300, file.output = FALSE, verbose = TRUE)</span></span>
<span id="cb157-5"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">CMplot</span>(wtccc1_assoc_complsub,</span>
<span id="cb157-7"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot.type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">LOG10 =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="cn">NULL</span>,</span>
<span id="cb157-8"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">threshold =</span> <span class="fu">c</span>(<span class="fl">1e-6</span>,<span class="fl">1e-4</span>), <span class="at">threshold.lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">threshold.lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">threshold.col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb157-9"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">amplify =</span> <span class="cn">TRUE</span>,</span>
<span id="cb157-10"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">bin.size =</span> <span class="fl">1e6</span>, <span class="at">chr.den.col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb157-11"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">signal.col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">signal.cex =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">signal.pch =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">19</span>),</span>
<span id="cb157-12"><a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#cb157-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">file =</span> <span class="st">&quot;jpg&quot;</span>, <span class="at">memo =</span> <span class="st">&quot;&quot;</span>, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">file.output =</span> <span class="cn">FALSE</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##  SNP-Density Plotting.</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1ResultsManhattan-1.png" width="672" /><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1ResultsManhattan-2.png" width="672" /></p>
<pre><code>##  Circular-Manhattan Plotting P.
##  Rectangular-Manhattan Plotting P.</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1ResultsManhattan-3.png" width="672" /></p>
<pre><code>##  QQ Plotting P.</code></pre>
<p><img src="A-primer-in-Human-Cardiovascular-Genetics_files/figure-html/WTCCC1ResultsManhattan-4.png" width="672" /></p>
</div>
<div id="replication" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Replication!<a href="wtccc1-a-gwas-on-coronary-artery-disease-cad.html#replication" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You reached an important milestone: you recreated the work by the whole WTCCC1-team that took them years in just one afternoon. Wow. Back then there wasn’t much on analyses <em>after</em> a GWAS, nowadays there are many post-GWAS analyses methods. We will cover them in the next (Chapter @ref(post_gwas)).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-welcome-trust-case-control-consortium-wtccc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="post-gwas-analyses.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/swvanderlaan/A_primer_in_Human_Cardiovascular_Genetics/edit/master/wtccc1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["A primer in Human Cardiovascular Genetics.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
